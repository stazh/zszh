{"version":3,"file":"pb-odd-editor.js","sources":["../node_modules/lit-html/directives/repeat.js","../node_modules/lit-html/directives/if-defined.js","../node_modules/@vaadin/vaadin-tabs/theme/lumo/vaadin-tab-styles.js","../node_modules/@vaadin/vaadin-item/src/vaadin-item-mixin.js","../node_modules/@vaadin/vaadin-tabs/src/vaadin-tab.js","../node_modules/@vaadin/vaadin-tabs/theme/lumo/vaadin-tabs-styles.js","../node_modules/@vaadin/vaadin-list-mixin/vaadin-list-mixin.js","../node_modules/@vaadin/vaadin-tabs/src/vaadin-tabs.js","../src/pb-odd-rendition-editor.js","../src/pb-odd-parameter-editor.js","../src/pb-odd-model-editor.js","../src/pb-odd-elementspec-editor.js","../src/pb-odd-editor.js"],"sourcesContent":["/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nimport { createMarker, directive, NodePart, removeNodes, reparentNodes } from '../lit-html.js';\n// Helper functions for manipulating parts\n// TODO(kschaaf): Refactor into Part API?\nconst createAndInsertPart = (containerPart, beforePart) => {\n    const container = containerPart.startNode.parentNode;\n    const beforeNode = beforePart === undefined ? containerPart.endNode :\n        beforePart.startNode;\n    const startNode = container.insertBefore(createMarker(), beforeNode);\n    container.insertBefore(createMarker(), beforeNode);\n    const newPart = new NodePart(containerPart.options);\n    newPart.insertAfterNode(startNode);\n    return newPart;\n};\nconst updatePart = (part, value) => {\n    part.setValue(value);\n    part.commit();\n    return part;\n};\nconst insertPartBefore = (containerPart, part, ref) => {\n    const container = containerPart.startNode.parentNode;\n    const beforeNode = ref ? ref.startNode : containerPart.endNode;\n    const endNode = part.endNode.nextSibling;\n    if (endNode !== beforeNode) {\n        reparentNodes(container, part.startNode, endNode, beforeNode);\n    }\n};\nconst removePart = (part) => {\n    removeNodes(part.startNode.parentNode, part.startNode, part.endNode.nextSibling);\n};\n// Helper for generating a map of array item to its index over a subset\n// of an array (used to lazily generate `newKeyToIndexMap` and\n// `oldKeyToIndexMap`)\nconst generateMap = (list, start, end) => {\n    const map = new Map();\n    for (let i = start; i <= end; i++) {\n        map.set(list[i], i);\n    }\n    return map;\n};\n// Stores previous ordered list of parts and map of key to index\nconst partListCache = new WeakMap();\nconst keyListCache = new WeakMap();\n/**\n * A directive that repeats a series of values (usually `TemplateResults`)\n * generated from an iterable, and updates those items efficiently when the\n * iterable changes based on user-provided `keys` associated with each item.\n *\n * Note that if a `keyFn` is provided, strict key-to-DOM mapping is maintained,\n * meaning previous DOM for a given key is moved into the new position if\n * needed, and DOM will never be reused with values for different keys (new DOM\n * will always be created for new keys). This is generally the most efficient\n * way to use `repeat` since it performs minimum unnecessary work for insertions\n * and removals.\n *\n * IMPORTANT: If providing a `keyFn`, keys *must* be unique for all items in a\n * given call to `repeat`. The behavior when two or more items have the same key\n * is undefined.\n *\n * If no `keyFn` is provided, this directive will perform similar to mapping\n * items to values, and DOM will be reused against potentially different items.\n */\nexport const repeat = directive((items, keyFnOrTemplate, template) => {\n    let keyFn;\n    if (template === undefined) {\n        template = keyFnOrTemplate;\n    }\n    else if (keyFnOrTemplate !== undefined) {\n        keyFn = keyFnOrTemplate;\n    }\n    return (containerPart) => {\n        if (!(containerPart instanceof NodePart)) {\n            throw new Error('repeat can only be used in text bindings');\n        }\n        // Old part & key lists are retrieved from the last update\n        // (associated with the part for this instance of the directive)\n        const oldParts = partListCache.get(containerPart) || [];\n        const oldKeys = keyListCache.get(containerPart) || [];\n        // New part list will be built up as we go (either reused from\n        // old parts or created for new keys in this update). This is\n        // saved in the above cache at the end of the update.\n        const newParts = [];\n        // New value list is eagerly generated from items along with a\n        // parallel array indicating its key.\n        const newValues = [];\n        const newKeys = [];\n        let index = 0;\n        for (const item of items) {\n            newKeys[index] = keyFn ? keyFn(item, index) : index;\n            newValues[index] = template(item, index);\n            index++;\n        }\n        // Maps from key to index for current and previous update; these\n        // are generated lazily only when needed as a performance\n        // optimization, since they are only required for multiple\n        // non-contiguous changes in the list, which are less common.\n        let newKeyToIndexMap;\n        let oldKeyToIndexMap;\n        // Head and tail pointers to old parts and new values\n        let oldHead = 0;\n        let oldTail = oldParts.length - 1;\n        let newHead = 0;\n        let newTail = newValues.length - 1;\n        // Overview of O(n) reconciliation algorithm (general approach\n        // based on ideas found in ivi, vue, snabbdom, etc.):\n        //\n        // * We start with the list of old parts and new values (and\n        //   arrays of their respective keys), head/tail pointers into\n        //   each, and we build up the new list of parts by updating\n        //   (and when needed, moving) old parts or creating new ones.\n        //   The initial scenario might look like this (for brevity of\n        //   the diagrams, the numbers in the array reflect keys\n        //   associated with the old parts or new values, although keys\n        //   and parts/values are actually stored in parallel arrays\n        //   indexed using the same head/tail pointers):\n        //\n        //      oldHead v                 v oldTail\n        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n        //   newParts: [ ,  ,  ,  ,  ,  ,  ]\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6] <- reflects the user's new\n        //                                      item order\n        //      newHead ^                 ^ newTail\n        //\n        // * Iterate old & new lists from both sides, updating,\n        //   swapping, or removing parts at the head/tail locations\n        //   until neither head nor tail can move.\n        //\n        // * Example below: keys at head pointers match, so update old\n        //   part 0 in-place (no need to move it) and record part 0 in\n        //   the `newParts` list. The last thing we do is advance the\n        //   `oldHead` and `newHead` pointers (will be reflected in the\n        //   next diagram).\n        //\n        //      oldHead v                 v oldTail\n        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n        //   newParts: [0,  ,  ,  ,  ,  ,  ] <- heads matched: update 0\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    and advance both oldHead\n        //                                      & newHead\n        //      newHead ^                 ^ newTail\n        //\n        // * Example below: head pointers don't match, but tail\n        //   pointers do, so update part 6 in place (no need to move\n        //   it), and record part 6 in the `newParts` list. Last,\n        //   advance the `oldTail` and `oldHead` pointers.\n        //\n        //         oldHead v              v oldTail\n        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n        //   newParts: [0,  ,  ,  ,  ,  , 6] <- tails matched: update 6\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    and advance both oldTail\n        //                                      & newTail\n        //         newHead ^              ^ newTail\n        //\n        // * If neither head nor tail match; next check if one of the\n        //   old head/tail items was removed. We first need to generate\n        //   the reverse map of new keys to index (`newKeyToIndexMap`),\n        //   which is done once lazily as a performance optimization,\n        //   since we only hit this case if multiple non-contiguous\n        //   changes were made. Note that for contiguous removal\n        //   anywhere in the list, the head and tails would advance\n        //   from either end and pass each other before we get to this\n        //   case and removals would be handled in the final while loop\n        //   without needing to generate the map.\n        //\n        // * Example below: The key at `oldTail` was removed (no longer\n        //   in the `newKeyToIndexMap`), so remove that part from the\n        //   DOM and advance just the `oldTail` pointer.\n        //\n        //         oldHead v           v oldTail\n        //   oldKeys:  [0, 1, 2, 3, 4, 5, 6]\n        //   newParts: [0,  ,  ,  ,  ,  , 6] <- 5 not in new map: remove\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    5 and advance oldTail\n        //         newHead ^           ^ newTail\n        //\n        // * Once head and tail cannot move, any mismatches are due to\n        //   either new or moved items; if a new key is in the previous\n        //   \"old key to old index\" map, move the old part to the new\n        //   location, otherwise create and insert a new part. Note\n        //   that when moving an old part we null its position in the\n        //   oldParts array if it lies between the head and tail so we\n        //   know to skip it when the pointers get there.\n        //\n        // * Example below: neither head nor tail match, and neither\n        //   were removed; so find the `newHead` key in the\n        //   `oldKeyToIndexMap`, and move that old part's DOM into the\n        //   next head position (before `oldParts[oldHead]`). Last,\n        //   null the part in the `oldPart` array since it was\n        //   somewhere in the remaining oldParts still to be scanned\n        //   (between the head and tail pointers) so that we know to\n        //   skip that old part on future iterations.\n        //\n        //         oldHead v        v oldTail\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n        //   newParts: [0, 2,  ,  ,  ,  , 6] <- stuck: update & move 2\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    into place and advance\n        //                                      newHead\n        //         newHead ^           ^ newTail\n        //\n        // * Note that for moves/insertions like the one above, a part\n        //   inserted at the head pointer is inserted before the\n        //   current `oldParts[oldHead]`, and a part inserted at the\n        //   tail pointer is inserted before `newParts[newTail+1]`. The\n        //   seeming asymmetry lies in the fact that new parts are\n        //   moved into place outside in, so to the right of the head\n        //   pointer are old parts, and to the right of the tail\n        //   pointer are new parts.\n        //\n        // * We always restart back from the top of the algorithm,\n        //   allowing matching and simple updates in place to\n        //   continue...\n        //\n        // * Example below: the head pointers once again match, so\n        //   simply update part 1 and record it in the `newParts`\n        //   array.  Last, advance both head pointers.\n        //\n        //         oldHead v        v oldTail\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n        //   newParts: [0, 2, 1,  ,  ,  , 6] <- heads matched: update 1\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    and advance both oldHead\n        //                                      & newHead\n        //            newHead ^        ^ newTail\n        //\n        // * As mentioned above, items that were moved as a result of\n        //   being stuck (the final else clause in the code below) are\n        //   marked with null, so we always advance old pointers over\n        //   these so we're comparing the next actual old value on\n        //   either end.\n        //\n        // * Example below: `oldHead` is null (already placed in\n        //   newParts), so advance `oldHead`.\n        //\n        //            oldHead v     v oldTail\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6] <- old head already used:\n        //   newParts: [0, 2, 1,  ,  ,  , 6]    advance oldHead\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]\n        //               newHead ^     ^ newTail\n        //\n        // * Note it's not critical to mark old parts as null when they\n        //   are moved from head to tail or tail to head, since they\n        //   will be outside the pointer range and never visited again.\n        //\n        // * Example below: Here the old tail key matches the new head\n        //   key, so the part at the `oldTail` position and move its\n        //   DOM to the new head position (before `oldParts[oldHead]`).\n        //   Last, advance `oldTail` and `newHead` pointers.\n        //\n        //               oldHead v  v oldTail\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n        //   newParts: [0, 2, 1, 4,  ,  , 6] <- old tail matches new\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]   head: update & move 4,\n        //                                     advance oldTail & newHead\n        //               newHead ^     ^ newTail\n        //\n        // * Example below: Old and new head keys match, so update the\n        //   old head part in place, and advance the `oldHead` and\n        //   `newHead` pointers.\n        //\n        //               oldHead v oldTail\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n        //   newParts: [0, 2, 1, 4, 3,   ,6] <- heads match: update 3\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]    and advance oldHead &\n        //                                      newHead\n        //                  newHead ^  ^ newTail\n        //\n        // * Once the new or old pointers move past each other then all\n        //   we have left is additions (if old list exhausted) or\n        //   removals (if new list exhausted). Those are handled in the\n        //   final while loops at the end.\n        //\n        // * Example below: `oldHead` exceeded `oldTail`, so we're done\n        //   with the main loop.  Create the remaining part and insert\n        //   it at the new head position, and the update is complete.\n        //\n        //                   (oldHead > oldTail)\n        //   oldKeys:  [0, 1, -, 3, 4, 5, 6]\n        //   newParts: [0, 2, 1, 4, 3, 7 ,6] <- create and insert 7\n        //   newKeys:  [0, 2, 1, 4, 3, 7, 6]\n        //                     newHead ^ newTail\n        //\n        // * Note that the order of the if/else clauses is not\n        //   important to the algorithm, as long as the null checks\n        //   come first (to ensure we're always working on valid old\n        //   parts) and that the final else clause comes last (since\n        //   that's where the expensive moves occur). The order of\n        //   remaining clauses is is just a simple guess at which cases\n        //   will be most common.\n        //\n        // * TODO(kschaaf) Note, we could calculate the longest\n        //   increasing subsequence (LIS) of old items in new position,\n        //   and only move those not in the LIS set. However that costs\n        //   O(nlogn) time and adds a bit more code, and only helps\n        //   make rare types of mutations require fewer moves. The\n        //   above handles removes, adds, reversal, swaps, and single\n        //   moves of contiguous items in linear time, in the minimum\n        //   number of moves. As the number of multiple moves where LIS\n        //   might help approaches a random shuffle, the LIS\n        //   optimization becomes less helpful, so it seems not worth\n        //   the code at this point. Could reconsider if a compelling\n        //   case arises.\n        while (oldHead <= oldTail && newHead <= newTail) {\n            if (oldParts[oldHead] === null) {\n                // `null` means old part at head has already been used\n                // below; skip\n                oldHead++;\n            }\n            else if (oldParts[oldTail] === null) {\n                // `null` means old part at tail has already been used\n                // below; skip\n                oldTail--;\n            }\n            else if (oldKeys[oldHead] === newKeys[newHead]) {\n                // Old head matches new head; update in place\n                newParts[newHead] =\n                    updatePart(oldParts[oldHead], newValues[newHead]);\n                oldHead++;\n                newHead++;\n            }\n            else if (oldKeys[oldTail] === newKeys[newTail]) {\n                // Old tail matches new tail; update in place\n                newParts[newTail] =\n                    updatePart(oldParts[oldTail], newValues[newTail]);\n                oldTail--;\n                newTail--;\n            }\n            else if (oldKeys[oldHead] === newKeys[newTail]) {\n                // Old head matches new tail; update and move to new tail\n                newParts[newTail] =\n                    updatePart(oldParts[oldHead], newValues[newTail]);\n                insertPartBefore(containerPart, oldParts[oldHead], newParts[newTail + 1]);\n                oldHead++;\n                newTail--;\n            }\n            else if (oldKeys[oldTail] === newKeys[newHead]) {\n                // Old tail matches new head; update and move to new head\n                newParts[newHead] =\n                    updatePart(oldParts[oldTail], newValues[newHead]);\n                insertPartBefore(containerPart, oldParts[oldTail], oldParts[oldHead]);\n                oldTail--;\n                newHead++;\n            }\n            else {\n                if (newKeyToIndexMap === undefined) {\n                    // Lazily generate key-to-index maps, used for removals &\n                    // moves below\n                    newKeyToIndexMap = generateMap(newKeys, newHead, newTail);\n                    oldKeyToIndexMap = generateMap(oldKeys, oldHead, oldTail);\n                }\n                if (!newKeyToIndexMap.has(oldKeys[oldHead])) {\n                    // Old head is no longer in new list; remove\n                    removePart(oldParts[oldHead]);\n                    oldHead++;\n                }\n                else if (!newKeyToIndexMap.has(oldKeys[oldTail])) {\n                    // Old tail is no longer in new list; remove\n                    removePart(oldParts[oldTail]);\n                    oldTail--;\n                }\n                else {\n                    // Any mismatches at this point are due to additions or\n                    // moves; see if we have an old part we can reuse and move\n                    // into place\n                    const oldIndex = oldKeyToIndexMap.get(newKeys[newHead]);\n                    const oldPart = oldIndex !== undefined ? oldParts[oldIndex] : null;\n                    if (oldPart === null) {\n                        // No old part for this value; create a new one and\n                        // insert it\n                        const newPart = createAndInsertPart(containerPart, oldParts[oldHead]);\n                        updatePart(newPart, newValues[newHead]);\n                        newParts[newHead] = newPart;\n                    }\n                    else {\n                        // Reuse old part\n                        newParts[newHead] =\n                            updatePart(oldPart, newValues[newHead]);\n                        insertPartBefore(containerPart, oldPart, oldParts[oldHead]);\n                        // This marks the old part as having been used, so that\n                        // it will be skipped in the first two checks above\n                        oldParts[oldIndex] = null;\n                    }\n                    newHead++;\n                }\n            }\n        }\n        // Add parts for any remaining new values\n        while (newHead <= newTail) {\n            // For all remaining additions, we insert before last new\n            // tail, since old pointers are no longer valid\n            const newPart = createAndInsertPart(containerPart, newParts[newTail + 1]);\n            updatePart(newPart, newValues[newHead]);\n            newParts[newHead++] = newPart;\n        }\n        // Remove any remaining unused old parts\n        while (oldHead <= oldTail) {\n            const oldPart = oldParts[oldHead++];\n            if (oldPart !== null) {\n                removePart(oldPart);\n            }\n        }\n        // Save order of new parts for next round\n        partListCache.set(containerPart, newParts);\n        keyListCache.set(containerPart, newKeys);\n    };\n});\n//# sourceMappingURL=repeat.js.map","/**\n * @license\n * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\nimport { AttributePart, directive } from '../lit-html.js';\nconst previousValues = new WeakMap();\n/**\n * For AttributeParts, sets the attribute if the value is defined and removes\n * the attribute if the value is undefined.\n *\n * For other part types, this directive is a no-op.\n */\nexport const ifDefined = directive((value) => (part) => {\n    const previousValue = previousValues.get(part);\n    if (value === undefined && part instanceof AttributePart) {\n        // If the value is undefined, remove the attribute, but only if the value\n        // was previously defined.\n        if (previousValue !== undefined || !previousValues.has(part)) {\n            const name = part.committer.name;\n            part.committer.element.removeAttribute(name);\n        }\n    }\n    else if (value !== previousValue) {\n        part.setValue(value);\n    }\n    previousValues.set(part, value);\n});\n//# sourceMappingURL=if-defined.js.map","import '@vaadin/vaadin-lumo-styles/color.js';\nimport '@vaadin/vaadin-lumo-styles/sizing.js';\nimport '@vaadin/vaadin-lumo-styles/style.js';\nimport '@vaadin/vaadin-lumo-styles/typography.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst $_documentContainer = html`<dom-module id=\"lumo-tab\" theme-for=\"vaadin-tab\">\n  <template>\n    <style>\n      :host {\n        box-sizing: border-box;\n        padding: 0.5rem 0.75rem;\n        font-family: var(--lumo-font-family);\n        font-size: var(--lumo-font-size-m);\n        line-height: var(--lumo-line-height-xs);\n        font-weight: 500;\n        opacity: 1;\n        color: var(--lumo-contrast-60pct);\n        transition: 0.15s color, 0.2s transform;\n        flex-shrink: 0;\n        display: flex;\n        align-items: center;\n        position: relative;\n        cursor: pointer;\n        transform-origin: 50% 100%;\n        outline: none;\n        -webkit-font-smoothing: antialiased;\n        -moz-osx-font-smoothing: grayscale;\n        overflow: hidden;\n        min-width: var(--lumo-size-m);\n        -webkit-user-select: none;\n        -moz-user-select: none;\n        -ms-user-select: none;\n        user-select: none;\n      }\n\n      :host(:not([orientation=\"vertical\"])) {\n        text-align: center;\n      }\n\n      :host([orientation=\"vertical\"]) {\n        transform-origin: 0% 50%;\n        padding: 0.25rem 1rem;\n        min-height: var(--lumo-size-m);\n        min-width: 0;\n      }\n\n      :host(:hover),\n      :host([focus-ring]) {\n        color: var(--lumo-body-text-color);\n      }\n\n      :host([selected]) {\n        color: var(--lumo-primary-text-color);\n        transition: 0.6s color;\n      }\n\n      :host([active]:not([selected])) {\n        color: var(--lumo-primary-text-color);\n        transition-duration: 0.1s;\n      }\n\n      :host::before,\n      :host::after {\n        content: \"\";\n        position: absolute;\n        display: var(--_lumo-tab-marker-display, block);\n        bottom: 0;\n        left: 50%;\n        width: var(--lumo-size-s);\n        height: 2px;\n        background-color: var(--lumo-contrast-60pct);\n        border-radius: var(--lumo-border-radius) var(--lumo-border-radius) 0 0;\n        transform: translateX(-50%) scale(0);\n        transform-origin: 50% 100%;\n        transition: 0.14s transform cubic-bezier(.12, .32, .54, 1);\n        will-change: transform;\n      }\n\n      :host([selected])::before,\n      :host([selected])::after {\n        background-color: var(--lumo-primary-color);\n      }\n\n      :host([orientation=\"vertical\"])::before,\n      :host([orientation=\"vertical\"])::after {\n        left: 0;\n        bottom: 50%;\n        transform: translateY(50%) scale(0);\n        width: 2px;\n        height: var(--lumo-size-xs);\n        border-radius: 0 var(--lumo-border-radius) var(--lumo-border-radius) 0;\n        transform-origin: 100% 50%;\n      }\n\n      :host::after {\n        box-shadow: 0 0 0 4px var(--lumo-primary-color);\n        opacity: 0.15;\n        transition: 0.15s 0.02s transform, 0.8s 0.17s opacity;\n      }\n\n      :host([selected])::before,\n      :host([selected])::after {\n        transform: translateX(-50%) scale(1);\n        transition-timing-function: cubic-bezier(.12, .32, .54, 1.5);\n      }\n\n      :host([orientation=\"vertical\"][selected])::before,\n      :host([orientation=\"vertical\"][selected])::after {\n        transform: translateY(50%) scale(1);\n      }\n\n      :host([selected]:not([active]))::after {\n        opacity: 0;\n      }\n\n      :host(:not([orientation=\"vertical\"])) ::slotted(a[href]) {\n        justify-content: center;\n      }\n\n      :host ::slotted(a) {\n        display: flex;\n        width: 100%;\n        align-items: center;\n        height: 100%;\n        margin: -0.5rem -0.75rem;\n        padding: 0.5rem 0.75rem;\n        outline: none;\n\n        /*\n          Override the CSS inherited from \\`lumo-color\\` and \\`lumo-typography\\`.\n          Note: \\`!important\\` is needed because of the \\`:slotted\\` specificity.\n        */\n        text-decoration: none !important;\n        color: inherit !important;\n      }\n\n      :host ::slotted(iron-icon) {\n        margin: 0 4px;\n        width: var(--lumo-icon-size-m);\n        height: var(--lumo-icon-size-m);\n      }\n\n      /* Vaadin icons are based on a 16x16 grid (unlike Lumo and Material icons with 24x24), so they look too big by default */\n      :host ::slotted(iron-icon[icon^=\"vaadin:\"]) {\n        padding: 0.25rem;\n        box-sizing: border-box !important;\n      }\n\n      :host(:not([dir=\"rtl\"])) ::slotted(iron-icon:first-child) {\n        margin-left: 0;\n      }\n\n      :host(:not([dir=\"rtl\"])) ::slotted(iron-icon:last-child) {\n        margin-right: 0;\n      }\n\n      :host([theme~=\"icon-on-top\"]) {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: space-around;\n        text-align: center;\n        padding-bottom: 0.5rem;\n        padding-top: 0.25rem;\n      }\n\n      :host([theme~=\"icon-on-top\"]) ::slotted(a) {\n        flex-direction: column;\n        align-items: center;\n        margin-top: -0.25rem;\n        padding-top: 0.25rem;\n      }\n\n      :host([theme~=\"icon-on-top\"]) ::slotted(iron-icon) {\n        margin: 0;\n      }\n\n      /* Disabled */\n\n      :host([disabled]) {\n        pointer-events: none;\n        opacity: 1;\n        color: var(--lumo-disabled-text-color);\n      }\n\n      /* Focus-ring */\n\n      :host([focus-ring]) {\n        box-shadow: inset 0 0 0 2px var(--lumo-primary-color-50pct);\n        border-radius: var(--lumo-border-radius);\n      }\n\n      /* RTL specific styles */\n\n      :host([dir=\"rtl\"])::before,\n      :host([dir=\"rtl\"])::after {\n        left: auto;\n        right: 50%;\n        transform: translateX(50%) scale(0);\n      }\n\n      :host([dir=\"rtl\"][selected]:not([orientation=\"vertical\"]))::before,\n      :host([dir=\"rtl\"][selected]:not([orientation=\"vertical\"]))::after {\n        transform: translateX(50%) scale(1);\n      }\n\n      :host([dir=\"rtl\"]) ::slotted(iron-icon:first-child) {\n        margin-right: 0;\n      }\n\n      :host([dir=\"rtl\"]) ::slotted(iron-icon:last-child) {\n        margin-left: 0;\n      }\n\n      :host([orientation=\"vertical\"][dir=\"rtl\"]) {\n        transform-origin: 100% 50%;\n      }\n\n      :host([dir=\"rtl\"][orientation=\"vertical\"])::before,\n      :host([dir=\"rtl\"][orientation=\"vertical\"])::after {\n        left: auto;\n        right: 0;\n        border-radius: var(--lumo-border-radius) 0 0 var(--lumo-border-radius);\n        transform-origin: 0% 50%;\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\n/**\n * A mixin providing `focused`, `focus-ring`, `active`, `disabled` and `selected`.\n *\n * `focused`, `active` and `focus-ring` are set as only as attributes.\n * @polymerMixin\n */\nexport const ItemMixin = superClass => class VaadinItemMixin extends superClass {\n  static get properties() {\n    return {\n\n      /**\n       * Used for mixin detection because `instanceof` does not work with mixins.\n       * e.g. in VaadinListMixin it filters items by using the\n       * `element._hasVaadinItemMixin` condition.\n       * @type {boolean}\n       */\n      _hasVaadinItemMixin: {\n        value: true\n      },\n\n      /**\n       * If true, the user cannot interact with this element.\n       * @type {boolean}\n       */\n      disabled: {\n        type: Boolean,\n        value: false,\n        observer: '_disabledChanged',\n        reflectToAttribute: true\n      },\n\n      /**\n       * If true, the item is in selected state.\n       * @type {boolean}\n       */\n      selected: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true,\n        observer: '_selectedChanged'\n      },\n\n      /** @private */\n      _value: String\n    };\n  }\n\n  /**\n   * @return {string}\n   */\n  get value() {\n    return this._value !== undefined ? this._value : this.textContent.trim();\n  }\n\n  /**\n   * @param {string} value\n   */\n  set value(value) {\n    this._value = value;\n  }\n\n  /** @protected */\n  ready() {\n    super.ready();\n\n    const attrValue = this.getAttribute('value');\n    if (attrValue !== null) {\n      this.value = attrValue;\n    }\n\n    this.addEventListener('focus', e => this._setFocused(true), true);\n    this.addEventListener('blur', e => this._setFocused(false), true);\n    this.addEventListener('mousedown', e => {\n      this._setActive(this._mousedown = true);\n      const mouseUpListener = () => {\n        this._setActive(this._mousedown = false);\n        document.removeEventListener('mouseup', mouseUpListener);\n      };\n      document.addEventListener('mouseup', mouseUpListener);\n    });\n    this.addEventListener('keydown', e => this._onKeydown(e));\n    this.addEventListener('keyup', e => this._onKeyup(e));\n  }\n\n  /** @protected */\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    // in Firefox and Safari, blur does not fire on the element when it is removed,\n    // especially between keydown and keyup events, being active at the same time.\n    // reproducible in `<vaadin-select>` when closing overlay on select.\n    if (this.hasAttribute('active')) {\n      this._setFocused(false);\n    }\n  }\n\n  /** @private */\n  _selectedChanged(selected) {\n    this.setAttribute('aria-selected', selected);\n  }\n\n  /** @private */\n  _disabledChanged(disabled) {\n    if (disabled) {\n      this.selected = false;\n      this.setAttribute('aria-disabled', 'true');\n      this.blur();\n    } else {\n      this.removeAttribute('aria-disabled');\n    }\n  }\n\n  /**\n   * @param {boolean} focused\n   * @protected\n   */\n  _setFocused(focused) {\n    if (focused) {\n      this.setAttribute('focused', '');\n      if (!this._mousedown) {\n        this.setAttribute('focus-ring', '');\n      }\n    } else {\n      this.removeAttribute('focused');\n      this.removeAttribute('focus-ring');\n      this._setActive(false);\n    }\n  }\n\n  /**\n   * @param {boolean} active\n   * @protected\n   */\n  _setActive(active) {\n    if (active) {\n      this.setAttribute('active', '');\n    } else {\n      this.removeAttribute('active');\n    }\n  }\n\n  /**\n   * @param {!KeyboardEvent} event\n   * @protected\n   */\n  _onKeydown(event) {\n    if (/^( |SpaceBar|Enter)$/.test(event.key) && !event.defaultPrevented) {\n      event.preventDefault();\n      this._setActive(true);\n    }\n  }\n\n  /**\n   * @param {!KeyboardEvent} event\n   * @protected\n   */\n  _onKeyup(event) {\n    if (this.hasAttribute('active')) {\n      this._setActive(false);\n      this.click();\n    }\n  }\n};\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport { ThemableMixin } from '@vaadin/vaadin-themable-mixin/vaadin-themable-mixin.js';\nimport { ItemMixin } from '@vaadin/vaadin-item/src/vaadin-item-mixin.js';\nimport { ElementMixin } from '@vaadin/vaadin-element-mixin/vaadin-element-mixin.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n/**\n * `<vaadin-tab>` is a Web Component providing an accessible and customizable tab.\n *\n * ```\n *   <vaadin-tab>\n *     Tab 1\n *   </vaadin-tab>\n * ```\n *\n * The following state attributes are available for styling:\n *\n * Attribute  | Description | Part name\n * -----------|-------------|------------\n * `disabled` | Set to a disabled tab | :host\n * `focused` | Set when the element is focused | :host\n * `focus-ring` | Set when the element is keyboard focused | :host\n * `selected` | Set when the tab is selected | :host\n * `active` | Set when mousedown or enter/spacebar pressed | :host\n * `orientation` | Set to `horizontal` or `vertical` depending on the direction of items  | :host\n *\n * See [ThemableMixin â€“ how to apply styles for shadow parts](https://github.com/vaadin/vaadin-themable-mixin/wiki)\n *\n * @extends PolymerElement\n * @mixes ElementMixin\n * @mixes ThemableMixin\n * @mixes ItemMixin\n */\nclass TabElement extends ElementMixin(ThemableMixin(ItemMixin(PolymerElement))) {\n  static get template() {\n    return html`\n    <slot></slot>\n`;\n  }\n\n  static get is() {\n    return 'vaadin-tab';\n  }\n\n  static get version() {\n    return '3.2.0';\n  }\n\n  ready() {\n    super.ready();\n    this.setAttribute('role', 'tab');\n  }\n\n  /**\n   * @param {!KeyboardEvent} event\n   * @protected\n   */\n  _onKeyup(event) {\n    const willClick = this.hasAttribute('active');\n\n    super._onKeyup(event);\n\n    if (willClick) {\n      const anchor = this.querySelector('a');\n      if (anchor) {\n        anchor.click();\n      }\n    }\n  }\n}\n\ncustomElements.define(TabElement.is, TabElement);\n\nexport { TabElement };\n","import '@vaadin/vaadin-lumo-styles/font-icons.js';\nimport '@vaadin/vaadin-lumo-styles/color.js';\nimport '@vaadin/vaadin-lumo-styles/sizing.js';\nimport '@vaadin/vaadin-lumo-styles/spacing.js';\nimport '@vaadin/vaadin-lumo-styles/style.js';\nimport '@vaadin/vaadin-lumo-styles/typography.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\nconst $_documentContainer = html`<dom-module id=\"lumo-tabs\" theme-for=\"vaadin-tabs\">\n  <template>\n    <style>\n      :host {\n        -webkit-tap-highlight-color: transparent;\n      }\n\n      :host(:not([orientation=\"vertical\"])) {\n        box-shadow: inset 0 -1px 0 0 var(--lumo-contrast-10pct);\n        position: relative;\n        min-height: var(--lumo-size-l);\n      }\n\n      :host([orientation=\"horizontal\"]) [part=\"tabs\"] ::slotted(vaadin-tab:not([theme~=\"icon-on-top\"])) {\n        justify-content: center;\n      }\n\n      :host([orientation=\"vertical\"]) {\n        box-shadow: -1px 0 0 0 var(--lumo-contrast-10pct);\n      }\n\n      :host([orientation=\"horizontal\"]) [part=\"tabs\"] {\n        margin: 0 0.75rem;\n      }\n\n      :host([orientation=\"vertical\"]) [part=\"tabs\"] {\n        width: 100%;\n        margin: 0.5rem 0;\n      }\n\n      [part=\"forward-button\"],\n      [part=\"back-button\"] {\n        position: absolute;\n        z-index: 1;\n        font-family: lumo-icons;\n        color: var(--lumo-tertiary-text-color);\n        font-size: var(--lumo-icon-size-m);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        width: 1.5em;\n        height: 100%;\n        transition: 0.2s opacity;\n        top: 0;\n      }\n\n      [part=\"forward-button\"]:hover,\n      [part=\"back-button\"]:hover {\n        color: inherit;\n      }\n\n      :host(:not([dir=\"rtl\"])) [part=\"forward-button\"] {\n        right: 0;\n      }\n\n      [part=\"forward-button\"]::after {\n        content: var(--lumo-icons-angle-right);\n      }\n\n      [part=\"back-button\"]::after {\n        content: var(--lumo-icons-angle-left);\n      }\n\n      /* Tabs overflow */\n\n      [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: none;\n        -webkit-mask-image: var(--_lumo-tabs-overflow-mask-image);\n        /* For IE11 */\n        min-height: var(--lumo-size-l);\n      }\n\n      /*\n        TODO: CSS custom property in \\`mask-image\\` causes crash in Edge\n        see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/15415089/\n      */\n      @-moz-document url-prefix() {\n        [part=\"tabs\"] {\n          mask-image: var(--_lumo-tabs-overflow-mask-image);\n        }\n      }\n\n      /* Horizontal tabs overflow */\n\n      /* Both ends overflowing */\n      :host([overflow~=\"start\"][overflow~=\"end\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(90deg, transparent 2em, #000 4em, #000 calc(100% - 4em), transparent calc(100% - 2em));\n      }\n\n      /* End overflowing */\n      :host([overflow~=\"end\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(90deg, #000 calc(100% - 4em), transparent calc(100% - 2em));\n      }\n\n      /* Start overflowing */\n      :host([overflow~=\"start\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(90deg, transparent 2em, #000 4em);\n      }\n\n      /* Vertical tabs overflow */\n\n      /* Both ends overflowing */\n      :host([overflow~=\"start\"][overflow~=\"end\"][orientation=\"vertical\"]) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(transparent, #000 2em, #000 calc(100% - 2em), transparent);\n      }\n\n      /* End overflowing */\n      :host([overflow~=\"end\"][orientation=\"vertical\"]) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(#000 calc(100% - 2em), transparent);\n      }\n\n      /* Start overflowing */\n      :host([overflow~=\"start\"][orientation=\"vertical\"]) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(transparent, #000 2em);\n      }\n\n      :host [part=\"tabs\"] ::slotted(:not(vaadin-tab)) {\n        margin-left: var(--lumo-space-m);\n      }\n\n      /* Centered */\n\n      :host([theme~=\"centered\"][orientation=\"horizontal\"]) [part=\"tabs\"] {\n        justify-content: center;\n      }\n\n      /* Small */\n\n      :host([theme~=\"small\"]),\n      :host([theme~=\"small\"]) [part=\"tabs\"] {\n        min-height: var(--lumo-size-m);\n      }\n\n      :host([theme~=\"small\"]) [part=\"tabs\"] ::slotted(vaadin-tab) {\n        font-size: var(--lumo-font-size-s);\n      }\n\n      /* Minimal */\n\n      :host([theme~=\"minimal\"]) {\n        box-shadow: none;\n        /* This doesn't work with ShadyCSS */\n        --_lumo-tab-marker-display: none;\n      }\n\n      /* Workaround for the above ShadyCSS issue */\n      :host([theme~=\"minimal\"]) [part=\"tabs\"] ::slotted(vaadin-tab[selected])::before,\n      :host([theme~=\"minimal\"]) [part=\"tabs\"] ::slotted(vaadin-tab[selected])::after {\n        display: none;\n      }\n\n      /* Hide-scroll-buttons */\n\n      :host([theme~=\"hide-scroll-buttons\"]) [part=\"back-button\"],\n      :host([theme~=\"hide-scroll-buttons\"]) [part=\"forward-button\"] {\n        display: none;\n      }\n\n      :host([theme~=\"hide-scroll-buttons\"][overflow~=\"start\"][overflow~=\"end\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(90deg, transparent, #000 2em, #000 calc(100% - 2em), transparent 100%);\n      }\n\n      :host([theme~=\"hide-scroll-buttons\"][overflow~=\"end\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(90deg, #000 calc(100% - 2em), transparent 100%);\n      }\n\n      :host([theme~=\"hide-scroll-buttons\"][overflow~=\"start\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(90deg, transparent, #000 2em);\n      }\n\n      /* Equal-width tabs */\n      :host([theme~=\"equal-width-tabs\"]) {\n        flex: auto;\n      }\n\n      :host([theme~=\"equal-width-tabs\"]) [part=\"tabs\"] ::slotted(vaadin-tab) {\n        flex: 1 0 0%;\n      }\n\n      /* RTL specific styles */\n\n      :host([dir=\"rtl\"]) [part=\"forward-button\"]::after {\n        content: var(--lumo-icons-angle-left);\n      }\n\n      :host([dir=\"rtl\"]) [part=\"back-button\"]::after {\n        content: var(--lumo-icons-angle-right);\n      }\n\n      :host([orientation=\"vertical\"][dir=\"rtl\"]) {\n        box-shadow: 1px 0 0 0 var(--lumo-contrast-10pct);\n      }\n\n      :host([dir=\"rtl\"]) [part=\"forward-button\"] {\n        left: 0;\n      }\n\n      :host([dir=\"rtl\"]) [part=\"tabs\"] ::slotted(:not(vaadin-tab)) {\n        margin-left: 0;\n        margin-right: var(--lumo-space-m);\n      }\n\n      /* Both ends overflowing */\n      :host([dir=\"rtl\"][overflow~=\"start\"][overflow~=\"end\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(-90deg, transparent 2em, #000 4em, #000 calc(100% - 4em), transparent calc(100% - 2em));\n      }\n\n      /* End overflowing */\n      :host([dir=\"rtl\"][overflow~=\"end\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(-90deg, #000 calc(100% - 4em), transparent calc(100% - 2em));\n      }\n\n      /* Start overflowing */\n      :host([dir=\"rtl\"][overflow~=\"start\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(-90deg, transparent 2em, #000 4em);\n      }\n\n      :host([dir=\"rtl\"][theme~=\"hide-scroll-buttons\"][overflow~=\"start\"][overflow~=\"end\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(-90deg, transparent, #000 2em, #000 calc(100% - 2em), transparent 100%);\n      }\n\n      :host([dir=\"rtl\"][theme~=\"hide-scroll-buttons\"][overflow~=\"end\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(-90deg, #000 calc(100% - 2em), transparent 100%);\n      }\n\n      :host([dir=\"rtl\"][theme~=\"hide-scroll-buttons\"][overflow~=\"start\"]:not([orientation=\"vertical\"])) [part=\"tabs\"] {\n        --_lumo-tabs-overflow-mask-image: linear-gradient(-90deg, transparent, #000 2em);\n      }\n    </style>\n  </template>\n</dom-module>`;\n\ndocument.head.appendChild($_documentContainer.content);\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { FlattenedNodesObserver } from '@polymer/polymer/lib/utils/flattened-nodes-observer.js';\n\nimport { DirHelper } from '@vaadin/vaadin-element-mixin/vaadin-dir-helper.js';\nimport { Debouncer } from '@polymer/polymer/lib/utils/debounce.js';\nimport { timeOut } from '@polymer/polymer/lib/utils/async.js';\n\n/**\n * A mixin for `nav` elements, facilitating navigation and selection of childNodes.\n *\n * @polymerMixin\n */\nexport const ListMixin = superClass => class VaadinListMixin extends superClass {\n  static get properties() {\n    return {\n      /**\n       * Used for mixin detection because `instanceof` does not work with mixins.\n       * @type {boolean}\n       */\n      _hasVaadinListMixin: {\n        value: true\n      },\n\n      /**\n       * The index of the item selected in the items array.\n       * Note: Not updated when used in `multiple` selection mode.\n       */\n      selected: {\n        type: Number,\n        reflectToAttribute: true,\n        notify: true\n      },\n\n      /**\n       * Define how items are disposed in the dom.\n       * Possible values are: `horizontal|vertical`.\n       * It also changes navigation keys from left/right to up/down.\n       * @type {!ListOrientation}\n       */\n      orientation: {\n        type: String,\n        reflectToAttribute: true,\n        value: ''\n      },\n\n      /**\n       * The list of items from which a selection can be made.\n       * It is populated from the elements passed to the light DOM,\n       * and updated dynamically when adding or removing items.\n       *\n       * The item elements must implement `Vaadin.ItemMixin`.\n       *\n       * Note: unlike `<vaadin-combo-box>`, this property is read-only,\n       * so if you want to provide items by iterating array of data,\n       * you have to use `dom-repeat` and place it to the light DOM.\n       * @type {!Array<!Element> | undefined}\n       */\n      items: {\n        type: Array,\n        readOnly: true,\n        notify: true\n      },\n\n      /**\n       * The search buffer for the keyboard selection feature.\n       * @private\n       */\n      _searchBuf: {\n        type: String,\n        value: ''\n      }\n    };\n  }\n\n  static get observers() {\n    return ['_enhanceItems(items, orientation, selected, disabled)'];\n  }\n\n  /** @protected */\n  ready() {\n    super.ready();\n    this.addEventListener('keydown', e => this._onKeydown(e));\n    this.addEventListener('click', e => this._onClick(e));\n\n    this._observer = new FlattenedNodesObserver(this, info => {\n      this._setItems(this._filterItems(Array.from(this.children)));\n    });\n  }\n\n  /** @private */\n  _enhanceItems(items, orientation, selected, disabled) {\n    if (!disabled) {\n      if (items) {\n        this.setAttribute('aria-orientation', orientation || 'vertical');\n        this.items.forEach(item => {\n          orientation ? item.setAttribute('orientation', orientation) : item.removeAttribute('orientation');\n          item.updateStyles();\n        });\n\n        this._setFocusable(selected);\n\n        const itemToSelect = items[selected];\n        items.forEach(item => item.selected = item === itemToSelect);\n        if (itemToSelect && !itemToSelect.disabled) {\n          this._scrollToItem(selected);\n        }\n      }\n    }\n  }\n\n  /**\n   * @return {Element}\n   */\n  get focused() {\n    return this.getRootNode().activeElement;\n  }\n\n  /**\n   * @param {!Array<!Element>} array\n   * @return {!Array<!Element>}\n   * @protected\n   */\n  _filterItems(array) {\n    return array.filter(e => e._hasVaadinItemMixin);\n  }\n\n  /**\n   * @param {!MouseEvent} event\n   * @protected\n   */\n  _onClick(event) {\n    if (event.metaKey || event.shiftKey || event.ctrlKey || event.defaultPrevented) {\n      return;\n    }\n\n    const item = this._filterItems(event.composedPath())[0];\n    let idx;\n    if (item && !item.disabled && ((idx = this.items.indexOf(item)) >= 0)) {\n      this.selected = idx;\n    }\n  }\n\n  /**\n   * @param {number} currentIdx\n   * @param {string} key\n   * @return {number}\n   * @protected\n   */\n  _searchKey(currentIdx, key) {\n    this._searchReset = Debouncer.debounce(\n      this._searchReset,\n      timeOut.after(500),\n      () => this._searchBuf = ''\n    );\n    this._searchBuf += key.toLowerCase();\n    const increment = 1;\n    const condition = item => !(item.disabled || this._isItemHidden(item)) &&\n      item.textContent.replace(/[^a-zA-Z0-9]/g, '').toLowerCase().indexOf(this._searchBuf) === 0;\n\n    if (!this.items.some(item => item.textContent.replace(/[^a-zA-Z0-9]/g, '').toLowerCase().indexOf(this._searchBuf) === 0)) {\n      this._searchBuf = key.toLowerCase();\n    }\n\n    const idx = this._searchBuf.length === 1 ? currentIdx + 1 : currentIdx;\n    return this._getAvailableIndex(idx, increment, condition);\n  }\n\n  /**\n   * @return {boolean}\n   * @protected\n   */\n  get _isRTL() {\n    return !this._vertical && this.getAttribute('dir') === 'rtl';\n  }\n\n  /**\n   * @param {!KeyboardEvent} event\n   * @protected\n   */\n  _onKeydown(event) {\n    if (event.metaKey || event.ctrlKey) {\n      return;\n    }\n\n    // IE names for arrows do not include the Arrow prefix\n    const key = event.key.replace(/^Arrow/, '');\n\n    const currentIdx = this.items.indexOf(this.focused);\n\n    if (/[a-zA-Z0-9]/.test(key) && key.length === 1) {\n      const idx = this._searchKey(currentIdx, key);\n      if (idx >= 0) {\n        this._focus(idx);\n      }\n      return;\n    }\n\n    const condition = item => !(item.disabled || this._isItemHidden(item));\n    let idx, increment;\n\n    const dirIncrement = this._isRTL ? -1 : 1;\n\n    if (this._vertical && key === 'Up' || !this._vertical && key === 'Left') {\n      increment = -dirIncrement;\n      idx = currentIdx - dirIncrement;\n    } else if (this._vertical && key === 'Down' || !this._vertical && key === 'Right') {\n      increment = dirIncrement;\n      idx = currentIdx + dirIncrement;\n    } else if (key === 'Home') {\n      increment = 1;\n      idx = 0;\n    } else if (key === 'End') {\n      increment = -1;\n      idx = this.items.length - 1;\n    }\n\n    idx = this._getAvailableIndex(idx, increment, condition);\n    if (idx >= 0) {\n      this._focus(idx);\n      event.preventDefault();\n    }\n  }\n\n  /**\n   * @param {number} idx\n   * @param {number} increment\n   * @param {function(!Element):boolean} condition\n   * @return {number}\n   * @protected\n   */\n  _getAvailableIndex(idx, increment, condition) {\n    const totalItems = this.items.length;\n    for (let i = 0; typeof idx == 'number' && i < totalItems; i++, idx += (increment || 1)) {\n      if (idx < 0) {\n        idx = totalItems - 1;\n      } else if (idx >= totalItems) {\n        idx = 0;\n      }\n\n      const item = this.items[idx];\n\n      if (condition(item)) {\n        return idx;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * @param {!Element} item\n   * @return {boolean}\n   * @protected\n   */\n  _isItemHidden(item) {\n    return getComputedStyle(item).display === 'none';\n  }\n\n  /**\n   * @param {number} idx\n   * @protected\n   */\n  _setFocusable(idx) {\n    idx = this._getAvailableIndex(idx, 1, item => !item.disabled);\n    const item = this.items[idx] || this.items[0];\n    this.items.forEach(e => e.tabIndex = e === item ? 0 : -1);\n  }\n\n  /**\n   * @param {number} idx\n   * @protected\n   */\n  _focus(idx) {\n    const item = this.items[idx];\n    this.items.forEach(e => e.focused = e === item);\n    this._setFocusable(idx);\n    this._scrollToItem(idx);\n    item.focus();\n  }\n\n  focus() {\n    // In initialisation (e.g vaadin-select) observer might not been run yet.\n    this._observer && this._observer.flush();\n    const firstItem = this.querySelector('[tabindex=\"0\"]') || (this.items ? this.items[0] : null);\n    firstItem && firstItem.focus();\n  }\n\n  /**\n   * @return {!HTMLElement}\n   * @protected\n   */\n  get _scrollerElement() {\n    // Returning scroller element of the component\n  }\n\n  /**\n   * Scroll the container to have the next item by the edge of the viewport.\n   * @param {number} idx\n   * @protected\n   */\n  _scrollToItem(idx) {\n    const item = this.items[idx];\n    if (!item) {\n      return;\n    }\n\n    const props = this._vertical ? ['top', 'bottom'] :\n      this._isRTL ? ['right', 'left'] : ['left', 'right'];\n\n    const scrollerRect = this._scrollerElement.getBoundingClientRect();\n    const nextItemRect = (this.items[idx + 1] || item).getBoundingClientRect();\n    const prevItemRect = (this.items[idx - 1] || item).getBoundingClientRect();\n\n    let scrollDistance = 0;\n    if (!this._isRTL && nextItemRect[props[1]] >= scrollerRect[props[1]] ||\n      this._isRTL && nextItemRect[props[1]] <= scrollerRect[props[1]]) {\n      scrollDistance = nextItemRect[props[1]] - scrollerRect[props[1]];\n    } else if (!this._isRTL && prevItemRect[props[0]] <= scrollerRect[props[0]] ||\n      this._isRTL && prevItemRect[props[0]] >= scrollerRect[props[0]]) {\n      scrollDistance = prevItemRect[props[0]] - scrollerRect[props[0]];\n    }\n\n    this._scroll(scrollDistance);\n  }\n\n  /**\n   * @return {boolean}\n   * @protected\n   */\n  get _vertical() {\n    return this.orientation !== 'horizontal';\n  }\n\n  /**\n   * @param {number} pixels\n   * @protected\n   */\n  _scroll(pixels) {\n    if (this._vertical) {\n      this._scrollerElement['scrollTop'] += pixels;\n    } else {\n      const scrollType = DirHelper.detectScrollType();\n      const scrollLeft = DirHelper.getNormalizedScrollLeft(scrollType,\n        this.getAttribute('dir') || 'ltr', this._scrollerElement) + pixels;\n      DirHelper.setNormalizedScrollLeft(scrollType,\n        this.getAttribute('dir') || 'ltr', this._scrollerElement, scrollLeft);\n    }\n  }\n\n  /**\n   * Fired when the selection is changed.\n   * Not fired when used in `multiple` selection mode.\n   *\n   * @event selected-changed\n   * @param {Object} detail\n   * @param {Object} detail.value the index of the item selected in the items array.\n   */\n};\n","/**\n@license\nCopyright (c) 2017 Vaadin Ltd.\nThis program is available under Apache License Version 2.0, available at https://vaadin.com/license/\n*/\nimport { PolymerElement } from '@polymer/polymer/polymer-element.js';\n\nimport { ThemableMixin } from '@vaadin/vaadin-themable-mixin/vaadin-themable-mixin.js';\nimport { ListMixin } from '@vaadin/vaadin-list-mixin/vaadin-list-mixin.js';\nimport { IronResizableBehavior } from '@polymer/iron-resizable-behavior/iron-resizable-behavior.js';\nimport { ElementMixin } from '@vaadin/vaadin-element-mixin/vaadin-element-mixin.js';\nimport './vaadin-tab.js';\nimport { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport { afterNextRender } from '@polymer/polymer/lib/utils/render-status.js';\nimport { mixinBehaviors } from '@polymer/polymer/lib/legacy/class.js';\nconst safari10 = /Apple.* Version\\/(9|10)/.test(navigator.userAgent);\n\n/**\n * `<vaadin-tabs>` is a Web Component for easy switching between different views.\n *\n * ```\n *   <vaadin-tabs selected=\"4\">\n *     <vaadin-tab>Page 1</vaadin-tab>\n *     <vaadin-tab>Page 2</vaadin-tab>\n *     <vaadin-tab>Page 3</vaadin-tab>\n *     <vaadin-tab>Page 4</vaadin-tab>\n *   </vaadin-tabs>\n * ```\n *\n * ### Styling\n *\n * The following shadow DOM parts are available for styling:\n *\n * Part name         | Description\n * ------------------|--------------------------------------\n * `back-button`     | Button for moving the scroll back\n * `tabs`            | The tabs container\n * `forward-button`  | Button for moving the scroll forward\n *\n * The following state attributes are available for styling:\n *\n * Attribute  | Description | Part name\n * -----------|-------------|------------\n * `orientation` | Tabs disposition, valid values are `horizontal` and `vertical`. | :host\n * `overflow` | It's set to `start`, `end`, none or both. | :host\n *\n * See [ThemableMixin â€“ how to apply styles for shadow parts](https://github.com/vaadin/vaadin-themable-mixin/wiki)\n *\n * @extends PolymerElement\n * @mixes ElementMixin\n * @mixes ListMixin\n * @mixes ThemableMixin\n * @demo demo/index.html\n */\nclass TabsElement extends\n  ElementMixin(\n    ListMixin(\n      ThemableMixin(\n        mixinBehaviors([IronResizableBehavior], PolymerElement)))) {\n  static get template() {\n    return html`\n    <style>\n      :host {\n        display: flex;\n        align-items: center;\n      }\n\n      :host([hidden]) {\n        display: none !important;\n      }\n\n      :host([orientation=\"vertical\"]) {\n        display: block;\n      }\n\n      :host([orientation=\"horizontal\"]) [part=\"tabs\"] {\n        flex-grow: 1;\n        display: flex;\n        align-self: stretch;\n        overflow-x: auto;\n        -webkit-overflow-scrolling: touch;\n        -ms-overflow-style: none;\n      }\n\n      /* This seems more future-proof than \\`overflow: -moz-scrollbars-none\\` which is marked obsolete\n         and is no longer guaranteed to work:\n         https://developer.mozilla.org/en-US/docs/Web/CSS/overflow#Mozilla_Extensions */\n      @-moz-document url-prefix() {\n        :host([orientation=\"horizontal\"]) [part=\"tabs\"] {\n          overflow: hidden;\n        }\n      }\n\n      :host([orientation=\"horizontal\"]) [part=\"tabs\"]::-webkit-scrollbar {\n        display: none;\n      }\n\n      :host([orientation=\"vertical\"]) [part=\"tabs\"] {\n        height: 100%;\n        overflow-y: auto;\n        -webkit-overflow-scrolling: touch;\n      }\n\n      [part=\"back-button\"],\n      [part=\"forward-button\"] {\n        pointer-events: none;\n        opacity: 0;\n        cursor: default;\n      }\n\n      :host([overflow~=\"start\"]) [part=\"back-button\"],\n      :host([overflow~=\"end\"]) [part=\"forward-button\"] {\n        pointer-events: auto;\n        opacity: 1;\n      }\n\n      [part=\"back-button\"]::after {\n        content: 'â—€';\n      }\n\n      [part=\"forward-button\"]::after {\n        content: 'â–¶';\n      }\n\n      :host([orientation=\"vertical\"]) [part=\"back-button\"],\n      :host([orientation=\"vertical\"]) [part=\"forward-button\"] {\n        display: none;\n      }\n\n      /* RTL specific styles */\n\n      :host([dir=\"rtl\"]) [part=\"back-button\"]::after {\n        content: 'â–¶';\n      }\n\n      :host([dir=\"rtl\"]) [part=\"forward-button\"]::after {\n        content: 'â—€';\n      }\n    </style>\n    <div on-click=\"_scrollBack\" part=\"back-button\"></div>\n\n    <div id=\"scroll\" part=\"tabs\">\n      <slot></slot>\n    </div>\n\n    <div on-click=\"_scrollForward\" part=\"forward-button\"></div>\n`;\n  }\n\n  static get is() {\n    return 'vaadin-tabs';\n  }\n\n  static get version() {\n    return '3.2.0';\n  }\n\n  static get properties() {\n    return {\n      /**\n       * Set tabs disposition. Possible values are `horizontal|vertical`\n       * @type {!ListOrientation}\n       */\n      orientation: {\n        value: 'horizontal',\n        type: String\n      },\n\n      /**\n       * The index of the selected tab.\n       */\n      selected: {\n        value: 0,\n        type: Number\n      }\n    };\n  }\n\n  static get observers() {\n    return ['_updateOverflow(items.*, vertical)'];\n  }\n\n  ready() {\n    super.ready();\n    this.addEventListener('iron-resize', () => this._updateOverflow());\n    this._scrollerElement.addEventListener('scroll', () => this._updateOverflow());\n    this.setAttribute('role', 'tablist');\n\n    // Wait for the vaadin-tab elements to upgrade and get styled\n    afterNextRender(this, () => {\n      this._updateOverflow();\n    });\n  }\n\n  /** @private */\n  _scrollForward() {\n    this._scroll(-this.__direction * this._scrollOffset);\n  }\n\n  /** @private */\n  _scrollBack() {\n    this._scroll(this.__direction * this._scrollOffset);\n  }\n\n  /**\n   * @return {number}\n   * @protected\n   */\n  get _scrollOffset() {\n    return this._vertical ? this._scrollerElement.offsetHeight : this._scrollerElement.offsetWidth;\n  }\n\n  /**\n   * @return {!HTMLElement}\n   * @protected\n   */\n  get _scrollerElement() {\n    return this.$.scroll;\n  }\n\n  /** @private */\n  get __direction() {\n    return !this._vertical && this.getAttribute('dir') === 'rtl' ? 1 : -1;\n  }\n\n  /** @private */\n  _updateOverflow() {\n    const scrollPosition = this._vertical ? this._scrollerElement.scrollTop : this.__getNormalizedScrollLeft(this._scrollerElement);\n    let scrollSize = this._vertical ? this._scrollerElement.scrollHeight : this._scrollerElement.scrollWidth;\n    // In Edge we need to adjust the size in 1 pixel\n    scrollSize -= 1;\n\n    let overflow = scrollPosition > 0 ? 'start' : '';\n    overflow += scrollPosition + this._scrollOffset < scrollSize ? ' end' : '';\n\n    if (this.__direction == 1) {\n      overflow = overflow.replace(/start|end/gi, matched => {\n        return matched === 'start' ? 'end' : 'start';\n      });\n    }\n\n    overflow ? this.setAttribute('overflow', overflow.trim()) : this.removeAttribute('overflow');\n\n    this._repaintShadowNodesHack();\n  }\n\n  /** @private */\n  _repaintShadowNodesHack() {\n    // Safari 10 has an issue with repainting shadow root element styles when a host attribute changes.\n    // Need this workaround (toggle any inline css property on and off) until the issue gets fixed.\n    /* istanbul ignore if */\n    if (safari10 && this.root) {\n      const WEBKIT_PROPERTY = '-webkit-backface-visibility';\n      this.root.querySelectorAll('*').forEach(el => {\n        el.style[WEBKIT_PROPERTY] = 'visible';\n        el.style[WEBKIT_PROPERTY] = '';\n      });\n    }\n  }\n}\n\ncustomElements.define(TabsElement.is, TabsElement);\n\nexport { TabsElement };\n","// @ts-nocheck\nimport { LitElement, html, css } from 'lit-element';\n\nimport '@polymer/paper-dropdown-menu/paper-dropdown-menu.js';\nimport '@polymer/paper-listbox/paper-listbox.js';\nimport '@polymer/paper-item/paper-item.js';\nimport '@polymer/paper-icon-button/paper-icon-button.js';\nimport '@polymer/iron-icons/iron-icons.js';\n\nimport './pb-code-editor.js';\n\n\n/**\n * represents an odd parameter element for editing\n *\n * @customElement\n *\n * @polymer\n */\nexport class PbOddRenditionEditor extends LitElement {\n\n    static get styles() {\n        return css`\n            :host {\n                display: block;\n            }\n            .wrapper{\n                display:grid;\n                grid-template-columns:150px auto 50px;\n                grid-column-gap:20px;\n                grid-row-gap:20px;\n                margin-bottom:10px;\n            }\n\n            paper-dropdown-menu{\n            }\n            \n            paper-icon-button{\n                align-self:center;\n            }\n        `;\n    }\n\n    render() {\n        return html`\n        <div class=\"wrapper\">\n            <paper-dropdown-menu label=\"Scope\">\n                <paper-listbox id=\"scopeList\" slot=\"dropdown-content\" selected=\"${this.scope}\" attr-for-selected=\"value\"\n                    @iron-select=\"${this._listchanged}\">\n                      ${this.scopes.map(scope =>\n            html`\n                            <paper-item value=\"${scope}\">${scope}</paper-item>\n                        `)}\n                </paper-listbox>\n            </paper-dropdown-menu>\n            <pb-code-editor\n                id=\"editor\"\n                label=\"Rendition\"\n                code=\"${this.css}\"\n                mode=\"css\"\n                @code-changed=\"${this._handleCodeChange}\"></pb-code-editor>\n            <paper-icon-button @click=\"${this._remove}\" icon=\"delete\" title=\"delete this rendition\"></paper-icon-button>\n        </div>\n\n\n\n        <slot></slot>\n\n        `;\n    }\n\n\n    static get properties() {\n        return {\n            scopes: {\n                type: Array\n            },\n            css: {\n                type: String,\n                reflect: true\n            },\n            scope: {\n                type: String,\n                reflect: true\n            },\n            selected: {\n                type: String\n            }\n        };\n    }\n\n    constructor() {\n        super();\n        this.scopes = [\"\", \"before\", \"after\"];\n        this.css = '';\n        this.scope = '';\n        this.selected = '';\n        this._initialized = false;\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n        this.css = this.css.trim();\n        this.dispatchEvent(new CustomEvent('rendition-connected', { composed: true, bubbles: true, detail: { target: this } }));\n    }\n\n    firstUpdated(changedProperties) {\n        this.refreshEditor();\n        this._initialized = true;\n    }\n\n    refreshEditor() {\n        console.log('refreshEditor');\n        const editor = this.shadowRoot.getElementById('editor');\n        if (!editor) { return; }\n        editor.refresh();\n    }\n\n    _remove(ev) {\n        ev.preventDefault();\n        this.dispatchEvent(new CustomEvent('remove-rendition', {}));\n    }\n\n    _handleCodeChange() {\n        this.css = this.shadowRoot.getElementById('editor').getSource();\n        this.dispatchEvent(new CustomEvent('rendition-changed', { composed: true, bubbles: true, detail: { name: this.name, css: this.css, scope: this.scope } }));\n    }\n\n    _listchanged(e) {\n        const scopelist = this.shadowRoot.getElementById('scopeList');\n        this.scope = scopelist.selected;\n    }\n\n\n}\ncustomElements.define('pb-odd-rendition-editor', PbOddRenditionEditor);\n","// @ts-nocheck\nimport { LitElement, html, css } from 'lit-element';\n\nimport '@cwmr/paper-autocomplete/paper-autocomplete.js';\nimport '@polymer/paper-icon-button/paper-icon-button.js';\nimport '@polymer/paper-dropdown-menu/paper-dropdown-menu.js';\nimport '@polymer/paper-listbox/paper-listbox.js';\nimport '@polymer/paper-item/paper-item.js';\nimport '@cwmr/paper-autocomplete/paper-autocomplete';\n\nimport { cmpVersion } from './utils.js';\nimport './pb-code-editor.js';\n\nimport { get as i18n, translate } from \"./pb-i18n.js\";\n\n/**\n * represents an odd parameter element for editing\n *\n * @customElement\n *\n * @polymer\n */\nexport class PbOddParameterEditor extends LitElement {\n\n    static get styles() {\n        return css`\n            :host {\n                display: block;\n            }\n            .wrapper{\n                display:grid;\n                grid-template-columns:150px auto 50px 50px;\n                grid-column-gap:20px;\n                grid-row-gap:20px;\n                margin-bottom:10px;\n            }\n            paper-dropdown-menu{\n                align-self:start;\n            }\n            paper-icon-button, paper-checkbox {\n                align-self: center;\n                margin-top: 16px;\n            }\n        `;\n    }\n\n    render() {\n        return html`\n        <div class=\"wrapper\">\n            \n            <paper-autocomplete id=\"combo\" text=\"${this.name}\" placeholder=\"${translate('odd.editor.model.param-name-placeholder')}\" label=\"Name\" \n                .source=\"${this._currentParameters}\"></paper-autocomplete>\n\n            <pb-code-editor id=\"editor\"\n                        label=\"Parameter\"\n                        mode=\"xquery\"\n                        code=\"${this.value}\"\n                        linter=\"${this.endpoint}/${cmpVersion(this.apiVersion, '1.0.0') ? 'modules/editor.xql' : 'api/lint'}\"\n                        apiVersion=\"${this.apiVersion}\"></pb-code-editor>\n            <paper-checkbox id=\"set\" ?checked=\"${this.setParam}\" @change=\"${this._handleCodeChange}\">${translate('odd.editor.model.set-param')}</paper-checkbox>\n            <paper-icon-button @click=\"${this._delete}\" icon=\"delete\" title=\"delete this parameter\"></paper-icon-button>\n        </div>\n\n        \n        `;\n    }\n\n\n    static get properties() {\n        return {\n            /**\n             * the parameter name\n             */\n            name: {\n                type: String,\n                reflect: true\n            },\n            /**\n             * the parameter value\n             */\n            value: {\n                type: String,\n                reflect: true\n            },\n            behaviour: {\n                type: String\n            },\n            parameters: {\n                type: Object\n            },\n            setParam: {\n                type: Boolean,\n                attribute: 'set'\n            },\n            _currentParameters: {\n                type: Array\n            },\n            endpoint: {\n                type: String\n            },\n            apiVersion: {\n                type: String\n            }\n\n        };\n    }\n\n    constructor() {\n        super();\n        this.name = '';\n        this.value = '';\n        this.setParam = false;\n        this.behaviour = '';\n        this.currentParameters = [];\n        this.parameters = {\n            '': [],\n            alternate: [\"default\", \"alternate\", \"persistent\"],\n            anchor: [\"content\", \"id\"],\n            block: [\"content\"],\n            body: [\"content\"],\n            break: [\"content\", \"type\", \"label\"],\n            cell: [\"content\"],\n            cit: [\"content\", \"source\"],\n            \"document\": [\"content\"],\n            figure: [\"content\", \"title\"],\n            graphic: [\"content\", \"url\", \"width\", \"height\", \"scale\", \"title\"],\n            heading: [\"content\", \"level\"],\n            inline: [\"content\"],\n            link: [\"content\", \"uri\", \"target\"],\n            list: [\"content\", \"type\"],\n            listItem: [\"content\", \"n\"],\n            metadata: [\"content\"],\n            note: [\"content\", \"place\", \"label\"],\n            omit: [],\n            paragraph: [\"content\"],\n            row: [\"content\"],\n            section: [\"content\"],\n            table: [\"content\"],\n            text: [\"content\"],\n            title: [\"content\"],\n            webcomponent: [\"content\", \"name\"]\n        };\n\n        this.selected = '';\n        this.endpoint = '';\n\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n        this.value = this.value.trim();\n        this.dispatchEvent(new CustomEvent('parameter-connected', { composed: true, bubbles: true, detail: { target: this } }));\n    }\n\n    attributeChangedCallback(name, old, value) {\n        super.attributeChangedCallback(name, old, value);\n        if (name === 'behaviour') {\n            this._currentParameters = this.parameters[value];\n        }\n    }\n\n    firstUpdated(changedProperties) {\n        // console.log('parameters firstupdated ', changedProperties);\n        this.selected = this.parameters[this.behaviour] || [];\n        this.requestUpdate();\n\n        this.shadowRoot.getElementById('combo').addEventListener('focused-changed', this._handleCodeChange.bind(this));\n        this.shadowRoot.getElementById('editor').addEventListener('code-changed', this._handleCodeChange.bind(this));\n    }\n\n    refreshEditor() {\n        // console.log('parameters refresh');\n        const editor = this.shadowRoot.getElementById('editor');\n        if (!editor) { return; }\n        editor.refresh();\n    }\n\n\n    _delete(ev) {\n        console.log('parameter delete ', ev);\n        ev.preventDefault();\n        this.dispatchEvent(new CustomEvent('parameter-remove', {}));\n    }\n\n    /*\n        _handleChange(e) {\n            console.log('_handleChange ', e);\n            this.value = this.shadowRoot.getElementById('editor').getSource();\n            this.dispatchEvent(new CustomEvent('parameter-changed', {composed:true, bubbles:true, detail: {name: this.name, value: this.value}}));\n    \n        }\n    */\n\n    _handleCodeChange(e) {\n        console.log('_handleCodeChange ', e);\n        this.value = this.shadowRoot.getElementById('editor').getSource();\n        this.name = this.shadowRoot.getElementById('combo').text;\n        this.setParam = this.shadowRoot.getElementById('set').checked;\n        this.dispatchEvent(new CustomEvent('parameter-changed', { composed: true, bubbles: true, detail: { name: this.name, value: this.value, set: this.setParam } }));\n    }\n\n\n}\ncustomElements.define('pb-odd-parameter-editor', PbOddParameterEditor);\n","// @ts-nocheck\nimport { LitElement, html, css } from 'lit-element';\n\nimport { repeat } from 'lit-html/directives/repeat';\nimport { ifDefined } from 'lit-html/directives/if-defined';\n\nimport '@polymer/paper-icon-button/paper-icon-button.js';\nimport '@polymer/iron-icons/iron-icons.js';\nimport '@polymer/iron-icon/iron-icon.js';\nimport '@polymer/paper-input/paper-input.js';\nimport '@polymer/paper-menu-button/paper-menu-button.js';\nimport '@polymer/paper-dropdown-menu/paper-dropdown-menu.js';\nimport '@polymer/paper-listbox/paper-listbox.js';\nimport '@polymer/paper-item/paper-item.js';\nimport '@polymer/paper-styles/color.js';\nimport '@polymer/iron-collapse/iron-collapse.js';\n\nimport { cmpVersion } from './utils.js';\nimport './pb-odd-rendition-editor.js';\nimport './pb-odd-parameter-editor.js';\nimport './pb-code-editor.js';\nimport './pb-message.js';\n\nimport { get as i18n, translate } from \"./pb-i18n.js\";\n\n\n/**\n * represents an odd model element for editing\n *\n * @customElement\n *\n * @polymer\n */\nexport class PbOddModelEditor extends LitElement {\n\n    static get styles() {\n        return css`\n            :host {\n                display: flex;\n                flex-direction:column;\n            }\n            h1, h2, h3, h4, h5, h6 {\n                font-family: \"Oswald\", Verdana, \"Helvetica\", sans-serif;\n                font-weight: 400 !important;\n            }\n\n            form {\n                margin-bottom: 8px;\n            }\n\n            paper-input, paper-autocomplete {\n                margin-bottom: 16px;\n            }\n\n            .models {\n                margin-left:20px;\n                margin-top:10px;\n            }\n\n            .btn, .btn-group {\n                margin-top: 0;\n                margin-bottom: 0;\n            }\n\n            header {\n                // background-color: #d1dae0;\n                background:var(--paper-grey-300);\n                margin:0;\n            }\n\n            header div {\n                display: flex;\n                flex-direction: row;\n                justify-content: space-between;\n                align-items: center;\n            }\n\n            header h4 {\n                padding: 4px 8px;\n                margin: 0;\n                display: grid;\n                grid-template-columns: 40px 40% auto;\n            }\n            h4 .btn-group{\n                text-align: right;\n                display: none;\n            }\n\n            #toggle, .modelType{\n                align-self:center;\n            }\n\n            header div.info {\n                padding: 0 16px 4px;\n                margin: 0;\n                font-size: 85%;\n                display: block;\n                margin:0 0 0 32px;\n            }\n            header div.info *{\n                display: block;\n                line-height: 1.2;\n            }\n\n            header .outputDisplay{\n                text-transform: uppercase ;\n            }\n            header .description{\n                font-style: italic;\n            }\n\n            header .predicate {\n                color: #ff5722;\n            }\n\n            .predicate label, .template label {\n                display: block;\n                font-size: 12px;\n                font-weight: 300;\n                color: rgb(115, 115, 115);\n            }\n\n            .model-collapse {\n                color: #000000;\n                cursor: pointer;\n            }\n\n            .model-collapse:hover {\n                text-decoration: none;\n            }\n\n            .behaviour {\n                color: #ff5722;\n            }\n\n            .behaviour:before {\n                content: ' [';\n            }\n\n            .behaviour:after {\n                content: ']';\n            }\n\n            .behaviourWrapper{\n                display:grid;\n                grid-template-columns: 140px 40px 140px auto;\n            }\n            .behaviourWrapper > *{\n                display:inline;\n                align-self:stretch;\n            }\n            \n            .group {\n                margin: 0;\n                font-size: 16px;\n                font-weight: bold;\n            }\n\n            .group .title {\n                /*text-decoration: underline;*/\n            }\n\n            .renditions, .parameters {\n                padding-left: 16px;\n                border-left: 3px solid #e0e0e0;\n                margin-bottom:20px;\n            }\n\n            .renditions .group {\n                display: flex;\n                flex-direction: row;\n                justify-content: space-between;\n                align-items: center;\n            }\n\n            .predicate .form-control {\n                width: 100%;\n            }\n\n            .source {\n                text-decoration: none;\n                margin-bottom: 8px;\n            }\n\n            .selectOutput {\n                margin-right: 10px;\n            }\n\n            :host([currentselection]) > form > header{\n                @apply --shadow-elevation-4dp;\n                border-left:3px solid var(--paper-blue-500);\n            }\n\n            paper-menu-button paper-icon-button{\n                margin-left:-10px;\n            }\n\n            /* need to play it save for FF */\n            :host([currentselection]) > form > header > h4 > .btn-group{\n                display: inline-block;\n            }\n            iron-collapse{\n            }\n\n            .renditions{\n                margin-top:10px;\n            }\n            \n            .details{\n                padding:0px 50px 20px 20px;\n                background:var(--paper-grey-200);\n            }\n            \n            pb-code-editor {\n                margin-bottom: 20px;\n            }\n\n            .horizontal {\n                display: flex;\n                flex-wrap: wrap;\n                justify-content: space-between;\n            }\n\n            #mode {\n                min-width: 18em;\n            }\n        `;\n    }\n\n    static get properties() {\n        return {\n            /**\n             * maps to ODD Â´model` behaviour attribute\n             */\n            behaviour: {\n                type: String\n            },\n            /**\n             * maps to ODD `model` predicate\n             */\n            predicate: {\n                type: String,\n                reflect: true,\n                converter: (value, type) => {\n                    if (value.toLowerCase() === 'null') {\n                        return '';\n                    }\n                    return value;\n                }\n            },\n            type: {\n                type: String,\n                reflect: true\n            },\n            template: {\n                type: String,\n                reflect: true,\n                converter: (value, type) => {\n                    if (value.toLowerCase() === 'null') {\n                        return '';\n                    }\n                    return value;\n                }\n            },\n            output: {\n                type: String,\n                reflect: true,\n                converter: (value, type) => {\n                    if (value.toLowerCase() === 'null') {\n                        return '';\n                    }\n                    return value;\n                }\n            },\n            css: {\n                type: String,\n                converter: (value, type) => {\n                    if (value.toLowerCase() === 'null') {\n                        return '';\n                    }\n                    return value;\n                }\n            },\n            mode: {\n                type: String\n            },\n            model: {\n                type: Object\n            },\n            models: {\n                type: Array\n            },\n            parameters: {\n                type: Array\n            },\n            renditions: {\n                type: Array\n            },\n            desc: {\n                type: String,\n                converter: (value, type) => {\n                    if (value.toLowerCase() === 'null') {\n                        return '';\n                    }\n                    return value;\n                }\n            },\n            sourcerend: {\n                type: String\n            },\n            show: {\n                type: Boolean,\n                reflect: true\n            },\n            outputs: {\n                type: Array\n            },\n            behaviours: {\n                type: Array\n            },\n            icon: {\n                type: String\n            },\n            open: {\n                type: String\n            },\n            hasCustomBehaviour: {\n                type: Boolean\n            },\n            endpoint: {\n                type: String\n            },\n            apiVersion: {\n                type: String\n            }\n        };\n    }\n\n    constructor() {\n        super();\n        this.behaviour = 'inline';\n        this.predicate = '';\n        this.type = '';\n        this.template = '';\n        this.output = '';\n        this.css = '';\n        this.mode = '';\n        this.model = {};\n        this.model.models = [];\n        this.parameters = [];\n        this.renditions = [];\n        this.desc = '';\n        this.sourcerend = '';\n        this.show = false;\n\n        this.outputs = [\"\",\n            \"web\",\n            \"print\",\n            \"epub\",\n            \"fo\",\n            \"latex\",\n            \"plain\"];\n\n        this.parentModel = [];\n        this.behaviours = [\n            \"alternate\",\n            \"anchor\",\n            \"block\",\n            \"body\",\n            \"break\",\n            \"cell\",\n            \"cit\",\n            \"document\",\n            \"figure\",\n            \"graphic\",\n            \"heading\",\n            \"inline\",\n            \"link\",\n            \"list\",\n            \"listItem\",\n            \"metadata\",\n            \"note\",\n            \"omit\",\n            \"paragraph\",\n            \"pass-through\",\n            \"row\",\n            \"section\",\n            \"table\",\n            \"text\",\n            \"title\",\n            \"webcomponent\"\n        ];\n\n        this.icon = 'expand-more';\n        this.hasCustomBehaviour = false;\n    }\n\n    render() {\n        return html`\n        <form>\n            <header> \n                <h4>\n                    <paper-icon-button id=\"toggle\"\n                                       icon=\"${this.icon}\" @click=\"${this.toggle}\"\n                                       class=\"model-collapse\"></paper-icon-button>\n                                       \n                    <span class=\"modelType\">${this.type}<span class=\"behaviour\" ?hidden=\"${this._isGroupOrSequence()}\">${this.behaviour}</span></span>\n\n                    <span class=\"btn-group\">\n                        <paper-icon-button @click=\"${this._moveDown}\" icon=\"arrow-downward\"\n                                           title=\"move down\"></paper-icon-button>\n                        <paper-icon-button @click=\"${this._moveUp}\" icon=\"arrow-upward\"\n                                           title=\"move up\"></paper-icon-button>\n                        <paper-icon-button @click=\"${this._requestRemoval}\" icon=\"delete\" title=\"remove\"></paper-icon-button>\n                        <paper-icon-button @click=\"${this._copy}\" icon=\"content-copy\" title=\"copy\"></paper-icon-button>\n                        <paper-icon-button @click=\"${this._paste}\" icon=\"content-paste\"\n                                           ?hidden=\"${this._isModel}\"></paper-icon-button>\n\n                        ${this._isGroupOrSequence() ?\n                html`\n                            <paper-menu-button horizontal-align=\"right\">\n                                <paper-icon-button icon=\"add\" slot=\"dropdown-trigger\"></paper-icon-button>\n                                <paper-listbox id=\"modelType\" slot=\"dropdown-content\" @iron-select=\"${this._addNested}\"\n                                               attr-for-selected=\"value\">\n                                   ${this.type === 'modelSequence' ?\n                        html`\n                                            <paper-item value=\"model\">model</paper-item>\n                                        `: ''\n                    }\n                                   ${this.type === 'modelGrp' ?\n                        html`\n                                            <paper-item value=\"modelSequence\">modelSequence</paper-item>\n                                            <paper-item value=\"model\">model</paper-item>\n                                        `: ''\n                    }\n                                </paper-listbox>\n                            </paper-menu-button>\n                            `: ''}\n                    </span>\n                </h4>\n                <div class=\"info\">\n                    <div class=\"outputDisplay\">${this.output}</div>\n                    <div class=\"description\">${this.desc}</div>\n                    <div class=\"predicate\">${this.predicate}</div>\n                </p>\n            </header>\n            <iron-collapse id=\"details\" ?opened=\"${this.show}\" class=\"details\">\n                <div class=\"horizontal\">\n                    <paper-dropdown-menu class=\"selectOutput\" label=\"Output\">\n                        <paper-listbox id=\"output\" slot=\"dropdown-content\" attr-for-selected=\"value\"\n                                    selected=\"${this.output}\" @iron-select=\"${this._selectOutput}\">\n\n                            ${this.outputs.map((item) =>\n                            html`\n                                <paper-item value=\"${item}\">${item}</paper-item>\n                            `)}\n\n                        </paper-listbox>\n                    </paper-dropdown-menu>\n                    <paper-input id=\"mode\" .value=\"${this.mode}\"\n                        placeholder=\"${translate('odd.editor.model.mode-placeholder')}\"\n                        label=\"Mode\"\n                        @change=\"${this._inputMode}\"></paper-input>\n                </div>\n                <paper-input id=\"desc\" .value=\"${this.desc}\" placeholder=\"${translate('odd.editor.model.description-placeholder')}\"\n                    label=\"Description\" @change=\"${this._inputDesc}\"></paper-input>\n\n                <pb-code-editor id=\"predicate\"\n                     code=\"${this.predicate}\"   \n                     mode=\"xquery\"\n                     linter=\"${this.endpoint}/${cmpVersion(this.apiVersion, '1.0.0') < 0 ? 'modules/editor.xql' : 'api/lint'}\"\n                     label=\"Predicate\"\n                     placeholder=\"${translate('odd.editor.model.predicate-placeholder')}\"\n                     @code-changed=\"${this._updatePredicate}\"\n                     apiVersion=\"${this.apiVersion}\"></pb-code-editor>\n               \n                ${this._isModel()\n                ? html`\n                        <div>\n                            <div class=\"behaviourWrapper\">\n                                <paper-dropdown-menu label=\"behaviour\" id=\"behaviourMenu\" ?disabled=\"${this.hasCustomBehaviour}\">\n                                    <paper-listbox id=\"behaviour\" slot=\"dropdown-content\" attr-for-selected=\"value\"\n                                                   selected=\"${this.behaviour}\" @iron-select=\"${this._selectBehaviour}\">\n                                        ${this.behaviours.map((item) =>\n                    html`\n                                            <paper-item value=\"${item}\">${item}</paper-item>\n                                        `)}\n                                    </paper-listbox>\n                                </paper-dropdown-menu>\n                                <span style=\"align-self:center;justify-self: center;\"> ${translate('odd.editor.model.link-with-or')} </span>\n                                <paper-input id=\"custombehaviour\" label=\"\" @input=\"${this._handleCustomBehaviour}\" placeHolder=\"${translate('odd.editor.model.custom-behaviour-placeholder')}\"></paper-input>\n                                <span></span>\n                            </div>\n\n                                \n    \n                            <paper-input id=\"css\" .value=\"${this.css}\"\n                                placeholder=\"${translate('odd.editor.model.css-class-placeholder')}\"\n                                label=\"CSS Class\"\n                                @change=\"${this._inputCss}\"></paper-input>\n                                \n                            <pb-code-editor id=\"template\"\n                                             code=\"${this.template}\"\n                                             mode=\"${this.output === 'latex' ? 'stex' : 'xml'}\"\n                                             label=\"Template\"\n                                             placeholder=\"${translate('odd.editor.model.template-placeholder')}\"\n                                             @code-changed=\"${this._updateTemplate}\"\n                                             apiVersion=\"${this.apiVersion}\"></pb-code-editor>\n                        </div>\n        \n                        <div class=\"parameters\">\n                            <div class=\"group\">\n                                <span class=\"title\">Parameters</span>\n                                <paper-icon-button icon=\"add\"\n                                                   @click=\"${this._addParameter}\"></paper-icon-button>\n                            </div>\n                            ${repeat(this.parameters, (parameter) => parameter.name, (parameter, index) =>\n                        html`\n                                <pb-odd-parameter-editor \n                                       behaviour=\"${this.behaviour}\"\n                                       name=\"${parameter.name}\"\n                                       value=\"${parameter.value}\"\n                                       ?set=\"${parameter.set}\"\n                                       endpoint=\"${this.endpoint}\"\n                                       apiVersion=\"${this.apiVersion}\"\n                                       @parameter-remove=\"${(e) => this._removeParam(e, index)}\"\n                                       @parameter-changed=\"${(e) => this._updateParam(e, index)}\"\n                                       ></pb-odd-parameter-editor>\n                            `)}\n                        </div>\n\n                        <div class=\"renditions\">\n                            <div class=\"group\">\n                                <div>\n                                    <span class=\"title\">Renditions</span>\n                                    <paper-icon-button icon=\"add\" @click=\"${this._addRendition}\"></paper-icon-button>\n                                </div>\n                                <div class=\"source\">\n                                    <paper-checkbox ?checked=\"${this.sourcerend}\" id=\"sourcerend\">Use source rendition</paper-checkbox>\n                                </div>\n                            </div>\n\n                            ${repeat(this.renditions, (rendition) => rendition.name, (rendition, index) =>\n                            html`\n                                <pb-odd-rendition-editor scope=\"${rendition.scope}\"\n                                       css=\"${rendition.css}\"\n                                       @remove-rendition=\"${(e) => this._removeRendition(e, index)}\"\n                                       @rendition-changed=\"${(e) => this._updateRendition(e, index)}\"\n                                       ></pb-odd-rendition-editor>\n                            `)}\n\n                        </div>\n                    `\n                : ''\n            }\n            </iron-collapse>\n            \n            <div class=\"models\">\n                ${repeat(this.model.models, (model, index) => html`\n                <pb-odd-model-editor \n                    behaviour=\"${model.behaviour || 'inline'}\"\n                    predicate=\"${model.predicate}\"\n                    type=\"${model.type}\"\n                    output=\"${model.output}\"\n                    css=\"${model.css}\"\n                    mode=\"${model.mode}\"\n                    .model=\"${model}\"\n                    .parameters=\"${model.parameters}\"\n                    desc=\"${model.desc}\"\n                    sourcerend=\"${model.sourcerend}\"\n                    .renditions=\"${model.renditions}\"\n                    .template=\"${model.template}\"\n                    .show=\"${model.show}\"\n                    endpoint=\"${this.endpoint}\"\n                    apiVersion=\"${this.apiVersion}\"\n                    @model-remove=\"${this._removeModel}\"\n                    @model-move-down=\"${this._moveModelDown}\"\n                    @model-move-up=\"${this._moveModelUp}\"\n                    @model-changed=\"${this.handleModelChanged}\"\n                    @click=\"${ (e) => this.setCurrentSelection(e, index)}\"\n                    hasParent\n                    ></pb-odd-model-editor>\n            `)}\n    \n            </div> \n        </form> \n        <pb-message id=\"dialog\"></pb-message>\n        `;\n    }\n\n    firstUpdated() {\n        super.firstUpdated();\n\n        this.hasCustomBehaviour = this.behaviours.indexOf(this.behaviour) < 0;\n        if (this.hasCustomBehaviour) {\n            this.shadowRoot.getElementById('custombehaviour').value = this.behaviour;\n        }\n    }\n\n    updated(_changedProperties) {\n        if (_changedProperties.has('show') && this.show) {\n            this.refreshEditors();\n        }\n    }\n\n    refreshEditors() {\n        console.log('refreshEditors');\n        this.shadowRoot.getElementById('predicate').refresh();\n\n        if (this._isGroupOrSequence()) { return console.log(\"asfdfa\"); }\n\n        this.shadowRoot.getElementById('template').refresh();\n\n        const models = this.shadowRoot.querySelectorAll('pb-odd-model-editor');\n        for (let i = 0; i < models.length; i++) {\n            models[i].refreshEditors();\n        }\n        const renditions = this.shadowRoot.querySelectorAll('pb-odd-rendition-editor');\n        for (let i = 0; i < renditions.length; i++) {\n            renditions[i].refreshEditor();\n        }\n        const parameters = this.shadowRoot.querySelectorAll('pb-odd-parameter-editor');\n        for (let i = 0; i < parameters.length; i++) {\n            parameters[i].refreshEditor();\n        }\n    }\n\n    toggle(e) {\n        // e.stopPropagation()\n        // e.preventDefault()\n\n        this.show = !this.show;\n        this.toggleButtonIcon();\n\n        const oldModel = this.model;\n        const newModel = Object.assign({}, oldModel, { show: this.show });\n        this.model = newModel;\n        this.refreshEditors();\n        this.dispatchEvent(new CustomEvent('model-changed', { composed: true, bubbles: true, detail: { oldModel, newModel } }));\n    }\n\n    toggleButtonIcon() {\n        if (this.show) {\n            this.icon = 'expand-less';\n        }\n        else {\n            this.icon = 'expand-more';\n        }\n    }\n\n    _isModel() {\n        return this.type === 'model';\n    }\n\n    _isGroupOrSequence() {\n        return this.type !== 'model';\n    }\n\n    static _templateMode(output) {\n        switch (output) {\n            case 'latex':\n                return 'latex';\n            case 'web':\n            default:\n                return 'xml';\n        }\n    }\n\n    _changeSelection(e) {\n        if (e.detail.target == this) return;\n        e.preventDefault();\n        e.stopPropagation();\n        if (this.currentSelection != undefined) {\n            this.currentSelection.removeAttribute('currentselection');\n        }\n        const newSelection = e.detail.target;\n        newSelection.setAttribute('currentselection', 'true');\n        this.currentSelection = newSelection;\n    }\n\n    _requestRemoval(e) {\n        e.preventDefault();\n        this.dispatchEvent(new CustomEvent('model-remove'));\n    }\n\n    /**\n     * move model down in list\n     *\n     * @param e\n     * @event model-move-down dispatched to request the model to move down\n     */\n    _moveDown(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        // this.dispatchEvent(new CustomEvent('model-move-down'));\n        this.dispatchEvent(new CustomEvent('model-move-down', { composed: true, bubbles: true, detail: { model: this } }));\n    }\n\n    /**\n     * move model up in list\n     *\n     * @param e\n     * @event model-move-up dispatched to request the model to move up\n     */\n    _moveUp(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.dispatchEvent(new CustomEvent('model-move-up'));\n    }\n\n    _addNested(e) {\n        const newNestedModel = {\n            behaviour: 'inline',\n            css: '',\n            desc: '',\n            predicate: '',\n            type: e.detail.item.getAttribute('value'),\n            output: '',\n            sourcerend: false,\n            models: [],\n            mode: '',\n            parameters: [],\n            renditions: [],\n            template: '',\n            show: true\n        };\n\n        const oldModel = this.model;\n        const models = Array.from(this.model.models);\n        models.unshift(newNestedModel);\n        this.model = Object.assign({}, oldModel, { models });\n\n        // important to reset the listbox - otherwise next attempt to use it will fail if value has not changed\n        // use querySelector here instead of 'this.$' as listbox is in it's own <template>\n        const modelTypeSelector = this.shadowRoot.querySelector('#modelType')\n        modelTypeSelector.select(\"\");\n\n        this.dispatchEvent(new CustomEvent('model-changed', { composed: true, bubbles: true, detail: { oldModel, newModel: this.model } }));\n    }\n\n    _removeModel(ev) {\n        console.log('_removeModel ', ev);\n        ev.stopPropagation();\n        const { model } = ev.target;\n        const index = this.model.models.indexOf(model)\n\n        this.shadowRoot.getElementById('dialog')\n            .confirm(i18n('odd.editor.model.delete-model-label'), i18n('odd.editor.model.delete-model-message'))\n            .then(() => {\n                const oldModel = this.model;\n                const models = Array.from(this.model.models);\n                models.splice(index, 1);\n                this.model = Object.assign({}, oldModel, { models });\n                this.models = models;\n                this.dispatchEvent(new CustomEvent('model-changed', { composed: true, bubbles: true, detail: { oldModel, newModel: this.model } }));\n            }, () => null);\n    }\n\n    _moveModelDown(ev) {\n        console.log('MODEL._moveModelDown ', ev);\n        ev.stopPropagation();\n        const { model } = ev.target;\n        const index = this.model.models.indexOf(model)\n        if (index === this.model.models.length) {\n            return;\n        }\n        const oldModel = this.model;\n        const models = Array.from(this.model.models);\n        models.splice(index, 1);\n        models.splice(index + 1, 0, model);\n        this.model = Object.assign({}, oldModel, { models });\n\n        const targetModel = this.shadowRoot.querySelectorAll('pb-odd-model-editor')[index + 1];\n        this._setCurrentSelection(index + 1, targetModel);\n\n        this.dispatchEvent(new CustomEvent('model-changed', { composed: true, bubbles: true, detail: { oldModel, newModel: this.model } }));\n        this.requestUpdate();\n    }\n\n    _moveModelUp(ev) {\n        ev.stopPropagation();\n        const { model } = ev.target;\n        const index = this.model.models.indexOf(model)\n        if (index === 0) {\n            return;\n        }\n        const oldModel = this.model;\n        const models = Array.from(this.model.models);\n        // remove element from models\n        models.splice(index, 1);\n        // add element to new index\n        models.splice(index - 1, 0, model);\n        this.model = Object.assign({}, oldModel, { models });\n\n        const targetModel = this.shadowRoot.querySelectorAll('pb-odd-model-editor')[index - 1];\n        this._setCurrentSelection(index - 1, targetModel);\n\n        this.dispatchEvent(new CustomEvent('model-changed', { composed: true, bubbles: true, detail: { oldModel, newModel: this.model } }));\n        // this.requestUpdate();\n    }\n\n    handleModelChanged(ev) {\n        console.log('handleModelChanged ', ev, this);\n        ev.stopPropagation();\n        const oldModel = this.model;\n        const index = this.model.models.indexOf(ev.detail.oldModel);\n        const models = Array.from(this.model.models);\n        models.splice(index, 1, ev.detail.newModel);\n        this.model = Object.assign({}, oldModel, { models });\n        this.dispatchEvent(new CustomEvent('model-changed', { composed: true, bubbles: true, detail: { oldModel, newModel: this.model } }));\n    }\n\n\n    //todo: setCurrentSelection functions are redundant in model and elementspec components - do better\n    setCurrentSelection(e, index) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        //prevent event if model is already the current one\n        this._setCurrentSelection(index, e.target);\n    }\n\n    _setCurrentSelection(index, target) {\n        // console.log('_setCurrentSelection ', target);\n        const targetModel = this.shadowRoot.querySelectorAll('pb-odd-model-editor')[index];\n\n        if (!targetModel) { return; }\n\n        if (targetModel.hasAttribute('currentselection')) return;\n\n        this.dispatchEvent(new CustomEvent('current-changed', { composed: true, bubbles: true, detail: { target: target } }));\n        this.requestUpdate();\n    }\n\n    _inputDesc(e) {\n        this.desc = e.composedPath()[0].value;\n        this._fireModelChanged('desc', this.desc);\n    }\n\n    _selectOutput(e) {\n        this.output = e.composedPath()[0].selected;\n        this._fireModelChanged('output', this.output);\n    }\n\n    _updatePredicate(ev) {\n        this.predicate = this.shadowRoot.getElementById('predicate').getSource();\n        console.log('_updatePredicate ', this.predicate);\n        this._fireModelChanged('predicate', this.predicate);\n    }\n\n    _selectBehaviour(ev) {\n        this.behaviour = ev.composedPath()[0].selected;\n        this._fireModelChanged('behaviour', this.behaviour);\n    }\n\n    _inputCss(ev) {\n        this.css = ev.composedPath()[0].value;\n        this._fireModelChanged('css', this.css);\n    }\n\n    _inputMode(ev) {\n        this.mode = ev.composedPath()[0].value;\n        this._fireModelChanged('mode', this.mode);\n    }\n\n    _updateTemplate(ev) {\n        this.template = this.shadowRoot.getElementById('template').getSource();\n        this._fireModelChanged('template', this.template);\n    }\n\n    /**\n     * add a model parameter\n     *\n     * @param e\n     */\n    _addParameter(e) {\n        this.parameters.push({ name: \"\", value: \"\" });\n        this._fireModelChanged('parameters', this.parameters);\n    }\n\n    _updateParam(e, index) {\n        this.parameters[index].name = e.detail.name;\n        this.parameters[index].value = e.detail.value;\n        this.parameters[index].set = e.detail.set;\n        this._fireModelChanged('parameters', this.parameters);\n    }\n\n    /**\n     * remove a parameter\n     * @param e\n     * @param index\n     * @private\n     */\n    _removeParam(e, index) {\n        this.parameters.splice(index, 1);\n        this._fireModelChanged('parameters', this.parameters);\n    }\n\n    /**\n     * add a rendition\n     *\n     * @param ev\n     */\n    _addRendition(ev) {\n        this.renditions.push({\n            scope: '',\n            css: ''\n        });\n        this._fireModelChanged('renditions', this.renditions);\n    }\n\n    _updateRendition(e, index) {\n        this.renditions[index].css = e.detail.css;\n        this.renditions[index].scope = e.detail.scope;\n        this._fireModelChanged('renditions', this.renditions);\n    }\n\n    _removeRendition(e, index) {\n        this.renditions.splice(index, 1);\n        this._fireModelChanged('renditions', this.renditions);\n    }\n\n    _fireModelChanged(prop, value) {\n        const oldModel = this.model;\n        this.model = Object.assign({}, this.model, { [prop]: value });\n        console.log('model changed for %s: %o - %o', prop, value, this.model);\n        this.dispatchEvent(new CustomEvent('model-changed', { composed: true, bubbles: true, detail: { oldModel, newModel: this.model } }));\n        this.requestUpdate();\n    }\n\n    _copy(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n        console.log('odd-model.copy ', ev);\n        console.log('odd-model.copy data', this.model);\n\n        this.dispatchEvent(new CustomEvent('odd-copy', { composed: true, bubbles: true, detail: { model: this.model } }));\n    }\n\n    _paste(ev) {\n        console.log('model _paste ', ev);\n        this.dispatchEvent(new CustomEvent('odd-paste', { composed: true, bubbles: true, detail: { target: this } }));\n    }\n\n\n    _handleCustomBehaviour(e) {\n        this.behaviour = e.composedPath()[0].value;\n        this._fireModelChanged('behaviour', this.behaviour);\n\n        // en-/disable behaviour menu\n        if (this.behaviour === '') {\n            this.behaviour = 'inline';\n            this.hasCustomBehaviour = false;\n        } else {\n            this.hasCustomBehaviour = true;\n        }\n        this.requestUpdate();\n\n    }\n\n\n\n}\ncustomElements.define('pb-odd-model-editor', PbOddModelEditor);\n","// @ts-nocheck\n/* eslint-disable import/extensions */\nimport { LitElement, html, css } from 'lit-element'\n\nimport { repeat } from 'lit-html/directives/repeat';\n\nimport '@polymer/polymer/lib/elements/dom-repeat';\nimport '@polymer/iron-icons/iron-icons';\nimport '@polymer/iron-icon/iron-icon';\nimport '@polymer/paper-icon-button/paper-icon-button';\nimport '@polymer/paper-menu-button/paper-menu-button';\nimport '@polymer/paper-listbox/paper-listbox';\nimport '@polymer/paper-styles/color';\nimport '@polymer/paper-item/paper-item';\nimport '@polymer/iron-collapse/iron-collapse';\nimport './pb-message.js';\nimport './pb-odd-model-editor.js';\n\nimport { get as i18n, translate } from \"./pb-i18n.js\";\n\n/**\n * A wrapper for the popular codemirror code editor.\n *\n *\n * @customElement\n * @polymer\n */\nexport class PbOddElementspecEditor extends LitElement {\n\n    static get styles() {\n        return css`\n            :host {\n                display: block;\n                padding: 4px 10px;\n                height: auto;\n            }\n\n            h1, h2, h3, h4, h5, h6 {\n                font-family: \"Oswald\", Verdana, \"Helvetica\", sans-serif;\n                font-weight: 400 !important;\n            }\n            \n\n            input {\n                vertical-align: middle;\n            }\n\n            .ident {\n                display: inline-block;\n                font-size:26px;\n                position:relative;\n            }\n            .mode{\n                font-size:10px;\n                display:inline-block;\n                text-transform:uppercase;\n                border-radius:12px;\n                color:var(--paper-grey-700);\n                background:var(--paper-grey-300);\n                padding:2px 6px;\n                border:thin solid var(--paper-grey-500);\n                margin-left:6px;\n                position:absolute;\n                top:8px;\n            }\n            \n            :host([currentselection]){\n                    box-shadow: 0 6px 10px 0 rgba(0, 0, 0, 0.14),\n                    0 1px 18px 0 rgba(0, 0, 0, 0.12),\n                    0 3px 5px -1px rgba(0, 0, 0, 0.4);\n\n            }\n\n            :host([currentSelection]) > h3, :host([currentSelection]) > header{\n                border-left:thin solid var(--paper-blue-500);\n            }\n            \n\n            h3{\n                display:grid;\n                grid-template-columns:260px auto 160px;\n                align-items:center;\n            }\n            h3 .controls{\n                text-align: right;\n                margin-right: 10px;\n            }\n\n            h3 .ident{\n                align-self: center;\n             }\n\n            paper-menu-button paper-icon-button{\n                margin-left:-10px;\n            }\n\n            /*todo: this does not take effect*/\n            iron-collapse.models{\n                --iron-collapse-transition-duration:0.4s;\n            }\n            \n            .models{\n                padding:10px;\n            }\n        `;\n    }\n\n    static get properties() {\n        return {\n            // identifier for this Â´element-specÂ´\n            ident: {\n                type: String\n            },\n            /**\n             * mode for an Â´elementSpec` may be 'add', 'remove' or being undefined\n             */\n            mode: {\n                type: String\n            },\n            /**\n             * array of ODD `model` elements\n             */\n            models: {\n                type: Array\n            },\n            endpoint: {\n                type: String\n            },\n            apiVersion: {\n                type: String\n            }\n        };\n    }\n\n    constructor() {\n        super();\n        this.ident = '';\n        this.mode = '';\n        this.models = [];\n        this.icon = 'expand-more';\n    }\n\n    render() {\n        return html`   \n        <h3>\n            <span class=\"ident\">${this.ident}<span class=\"mode\">mode: ${this.mode}</span></span>\n            <span class=\"spacer\"></span>\n\n            <span class=\"controls\">\n                <paper-icon-button @click=\"${this._remove}\" icon=\"delete\"></paper-icon-button>\n                <paper-icon-button @click=\"${this._paste}\" icon=\"content-paste\"></paper-icon-button>\n                <paper-menu-button horizontal-align=\"right\">\n                    <paper-icon-button icon=\"add\" slot=\"dropdown-trigger\"></paper-icon-button>\n                    <paper-listbox id=\"addModel\" slot=\"dropdown-content\" @iron-select=\"${this._addModel}\"\n                                   attr-for-selected=\"value\">\n                        <paper-item value=\"model\">model</paper-item>\n                        <paper-item value=\"modelSequence\">modelSequence</paper-item>\n                        <paper-item value=\"modelGrp\">modelGrp</paper-item>\n                    </paper-listbox>\n                </paper-menu-button>\n\n\n            </span>\n        </h3>\n\n        <div>\n            ${repeat(this.models, (model, index) => html`\n            <pb-odd-model-editor\n                behaviour=\"${model.behaviour || ''}\"\n                predicate=\"${model.predicate}\"\n                type=\"${model.type}\"\n                output=\"${model.output}\"\n                css=\"${model.css}\"\n                mode=\"${model.mode}\"\n                .model=\"${model}\"\n                .parameters=\"${model.parameters}\"\n                desc=\"${model.desc}\"\n                .sourcerend=\"${model.sourcerend}\"\n                .renditions=\"${model.renditions}\"\n                .template=\"${model.template}\"\n                .show=\"${model.show}\"\n                .endpoint=\"${this.endpoint}\"\n                .apiVersion=\"${this.apiVersion}\"\n                @model-remove=\"${this._removeModel}\"\n                @model-move-down=\"${this._moveModelDown}\"\n                @model-move-up=\"${this._moveModelUp}\"\n                @model-changed=\"${this.handleModelChanged}\"\n                @click=\"${(e) => this.setCurrentSelection(e, index)}\"\n                ></pb-odd-model-editor>\n            `)}\n        </div>\n        <pb-message id=\"dialog\"></pb-message>\n        `;\n    }\n\n    addModel(newModel) {\n        this.models.unshift(newModel);\n        this.requestUpdate();\n    }\n\n    _addModel(e) {\n        console.log('ELEMENTSPEC._addModel ', e);\n        const addModel = this.shadowRoot.getElementById('addModel');\n        const newModel = {\n            behaviour: 'inline',\n            css: '',\n            mode: '',\n            predicate: '',\n            desc: '',\n            type: addModel.selected,\n            output: '',\n            template: '',\n            sourcerend: false,\n            models: [],\n            parameters: [],\n            renditions: [],\n            show: true\n        };\n\n        const models = Array.from(this.models);\n        models.unshift(newModel);\n        this.models = models;\n        this.dispatchEvent(new CustomEvent('element-spec-changed', { composed: true, bubbles: true, detail: { action: \"models\", ident: this.ident, models: this.models } }));\n        addModel.selected = \"\";\n        this.requestUpdate();\n\n    }\n\n\n    _remove(ev) {\n        this.dispatchEvent(new CustomEvent('element-spec-removed', {\n            composed: true, bubbles: true,\n            detail: { target: this }\n        }));\n    }\n\n    _paste(ev) {\n        console.log('_paste ', ev);\n        // const editor = document.querySelector('pb-odd-editor');\n        this.dispatchEvent(new CustomEvent('odd-paste', { composed: true, bubbles: true, detail: { target: this } }));\n    }\n\n    setCurrentSelection(e, index) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        //prevent event if model is already the current one\n        this._setCurrentSelection(index, e.target);\n    }\n\n    _setCurrentSelection(index, target) {\n        const targetModel = this.shadowRoot.querySelectorAll('pb-odd-model-editor')[index];\n        if (!targetModel) { return; }\n        if (targetModel.hasAttribute('currentselection')) return;\n\n        this.dispatchEvent(new CustomEvent('current-changed', { composed: true, bubbles: true, detail: { target: target } }));\n        this.requestUpdate();\n    }\n\n    _removeModel(ev) {\n        console.log('_removeModel ', ev);\n        ev.stopPropagation();\n        const { model } = ev.target;\n        const index = this.models.indexOf(model)\n\n        this.shadowRoot.getElementById('dialog')\n            .confirm(i18n('odd.editor.model.delete-model-label'), i18n('odd.editor.model.delete-model-message'))\n            .then(() => {\n                const models = Array.from(this.models);\n                models.splice(index, 1);\n                this.models = models;\n                this.dispatchEvent(new CustomEvent('element-spec-changed', { composed: true, bubbles: true, detail: { action: \"models\", ident: this.ident, models: this.models } }));\n            }, () => null);\n    }\n\n    _moveModelDown(ev) {\n        console.log('ELEMENTSPEC._moveModelDown ', ev);\n        ev.stopPropagation();\n        const { model } = ev.target;\n        const index = this.models.indexOf(model)\n        if (index === this.models.length) {\n            return;\n        }\n        const models = Array.from(this.models);\n        models.splice(index, 1);\n        models.splice(index + 1, 0, model);\n        this.models = models;\n\n        const targetModel = this.shadowRoot.querySelectorAll('pb-odd-model-editor')[index + 1];\n        if (!targetModel) { return; }\n        this._setCurrentSelection(index + 1, targetModel);\n\n        this.dispatchEvent(new CustomEvent('element-spec-changed', { composed: true, bubbles: true, detail: { action: \"models\", ident: this.ident, models: this.models } }));\n        // this.requestUpdate();\n    }\n\n    _moveModelUp(ev) {\n        ev.stopPropagation();\n        const { model } = ev.target;\n        const index = this.models.indexOf(model)\n        if (index === 0) {\n            return;\n        }\n        const models = Array.from(this.models);\n        // remove element from models\n        models.splice(index, 1);\n        // add element to new index\n        models.splice(index - 1, 0, model);\n        this.models = models;\n\n        const targetModel = this.shadowRoot.querySelectorAll('pb-odd-model-editor')[index - 1];\n        this._setCurrentSelection(index - 1, targetModel);\n\n        this.dispatchEvent(new CustomEvent('element-spec-changed', { composed: true, bubbles: true, detail: { action: \"models\", ident: this.ident, models: this.models } }));\n        // this.requestUpdate();\n    }\n\n    handleModelChanged(ev) {\n        // console.log('ELEMENTSPEC.handleModelChanged ', ev.detail);\n        ev.stopPropagation();\n        const index = this.models.indexOf(ev.detail.oldModel);\n        const models = Array.from(this.models);\n        models.splice(index, 1, ev.detail.newModel);\n        this.models = models;\n        this.dispatchEvent(new CustomEvent('element-spec-changed', { composed: true, bubbles: true, detail: { action: \"models\", ident: this.ident, models: this.models } }));\n        this.requestUpdate();\n    }\n\n}\ncustomElements.define('pb-odd-elementspec-editor', PbOddElementspecEditor);\n","// @ts-nocheck\nimport { LitElement, html, css } from 'lit-element'\nimport { pbMixin } from './pb-mixin.js';\nimport { pbHotkeys } from './pb-hotkeys.js';\nimport { repeat } from 'lit-html/directives/repeat';\nimport { ifDefined } from 'lit-html/directives/if-defined';\n\nimport '@vaadin/vaadin-tabs/vaadin-tabs';\nimport '@vaadin/vaadin-tabs/vaadin-tab';\n\nimport '@polymer/iron-ajax/iron-ajax';\nimport '@polymer/paper-styles/color';\nimport '@polymer/paper-card/paper-card';\nimport './pb-edit-xml.js';\nimport '@polymer/paper-icon-button/paper-icon-button';\nimport '@polymer/paper-input/paper-input';\nimport '@polymer/paper-item/paper-item';\nimport '@cwmr/paper-autocomplete/paper-autocomplete';\nimport './pb-collapse';\nimport '@polymer/paper-checkbox/paper-checkbox';\nimport './pb-odd-elementspec-editor.js';\nimport './pb-message.js';\n\nimport { get as i18n, translate } from \"./pb-i18n.js\";\nimport { PbOddElementspecEditor } from \"./pb-odd-elementspec-editor\";\n\n/**\n * ODD editor component\n *\n * @slot - default unnamed slot\n * @fires pb-login - When received, registers if user is logged in\n * @cssprop --pb-heading-font-family - font family used for headings\n * @cssprop --pb-heading-font-weight\n * @cssprop --pb-heading-line-height\n */\nexport class PbOddEditor extends pbHotkeys(pbMixin(LitElement)) {\n\n    static get styles() {\n        return css`\n            :host {\n                display: flex;\n                /*margin: 30px 20px;*/\n                margin:0;\n                padding:0;\n                height:auto;\n            }\n            \n            #layout {\n                width: 100%;\n                display: grid;\n                grid-template-columns: auto 1fr;\n                grid-template-rows: auto 1fr;\n            }\n\n            #drawer {\n                grid-column: 1 / 1;\n                min-width: 320px;\n            }\n\n            #navlist {\n                grid-column: 1 / 1;\n                grid-row: 2 / 2;\n                overflow: auto;\n                height: 100%;\n            }\n\n            .specs {\n                grid-column: 2 / 2;\n                grid-row: 1 / span 2;\n                overflow: auto;\n            }\n\n            section{\n                padding:20px;\n            }\n\n            h3, h4 {\n                font-family: var(--pb-heading-font-family);\n                font-weight: var(--pb-heading-font-weight);\n                line-height: var(--pb-heading-line-height);\n            }\n\n            /* ported over but not checked yet */\n\n            .specs {\n                padding:6px;\n            }\n\n            .metadata {\n                display: block;\n            }\n\n            .metadata div {\n                padding: 0 16px 16px;\n            }\n\n            .metadata paper-input {\n                margin-bottom: 10px;\n            }\n\n            .metadata .extCssEdit {\n                display: flex;\n                align-items: center;\n                padding: 0;\n            }\n            .metadata .extCssEdit paper-input {\n                flex: 2;\n            }\n            .metadata .extCssEdit pb-edit-xml {\n                width: 40px;\n            }\n\n            #jump-to {\n                margin-top: 1em;\n            }\n\n            odd-model {\n                border-bottom: 1px solid #E0E0E0;\n            }\n            odd-model h4 {\n                margin-top: 15px;\n                padding-top: 5px;\n                border-top: 1px solid #E0E0E0;\n            }\n            .renditions {\n                margin-top: 10px;\n            }\n            .icons{\n                display:inline-block;\n                white-space: nowrap;\n            }\n\n            /* todo: this doesn't work - should refactor to have the complete trigger exposed here (move out of pb-collapse) */\n            pb-collapse#meta ::slotted(.collapse-trigger){\n                /*height:56px;*/\n            }\n\n            iron-collapse {\n                --iron-collapse-transition-duration:0.8s;\n            }\n            \n            pb-message#errorMsg{\n                background: var(--paper-red-500);\n                color:white;\n            }\n            .card-content{\n                height:100%;\n                overflow:auto;\n            }\n            \n            paper-tab{\n                width:100px;\n            }\n            \n            .editingView {\n                width:100%;\n            }\n            \n            vaadin-tabs{\n                margin-top:10px;\n            }\n            \n            vaadin-tab{\n                background:var(--paper-grey-200);\n                padding:0 6px;\n                border:thin solid var(--paper-grey-300);\n                border-bottom:none;\n            }\n            vaadin-tab[selected]{\n                background:white;\n                border-top-right-radius:20px;\n                box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14),\n                    0 1px 5px 0 rgba(0, 0, 0, 0.12),\n                    0 3px 1px -2px rgba(0, 0, 0, 0.2);\n\n            }\n\n        `;\n    }\n\n    static get properties() {\n        return {\n            ...super.properties,\n            ident: {\n                type: String\n            },\n            /**\n             * ElementSpec mode. Can be Â´addÂ´, Â´changeÂ´ or undefined.\n             */\n            mode: {\n                type: String\n            },\n            /**\n             * Array of Â´odd-modelÂ´ Elements\n             */\n            models: {\n                type: Array\n            },\n            /**\n             * the odd file being edited\n             */\n            odd: {\n                type: String,\n                reflect: true\n            },\n            /**\n             * array of Â´element-specÂ´ Elements of given odd file\n             */\n            elementSpecs: {\n                type: Array\n            },\n            source: {\n                type: String\n            },\n            title: {\n                type: String\n            },\n            titleShort: {\n                type: String,\n                reflect: true,\n                attribute: 'title-short'\n            },\n            description: {\n                type: String\n            },\n            namespace: {\n                type: String\n            },\n            rootPath: {\n                type: String,\n                attribute: 'root-path'\n            },\n            loading: {\n                type: Boolean\n            },\n            indentString: {\n                type: String\n            },\n            outputPrefix: {\n                type: String,\n                attribute: 'output-prefix'\n            },\n            outputRoot: {\n                type: String,\n                attribute: 'output-root'\n            },\n            currentSelection: {\n                type: Object\n            },\n            useNamespace: {\n                type: Boolean\n            },\n            loggedIn: {\n                type: Boolean\n            },\n            tabs: {\n                type: Array\n            },\n            tabIndex: {\n                type: Number,\n                reflect: true\n            }\n        };\n    }\n\n    constructor() {\n        super();\n        this.ident = '';\n        this.mode = '';\n        this.models = () => [];\n        this.odd = '';\n        this.elementSpecs = [];\n        this.source = '';\n        this.title = '';\n        this.titleShort = '';\n        this.description = '';\n        this.namespace = '';\n        this.rootPath = '';\n        this.loading = false;\n        this.indentString = '    ';\n        this.outputPrefix = '';\n        this.outputRoot = '';\n        this.currentSelection = {};\n        this.useNamespace = false;\n        this.loggedIn = true;\n        this.tabs = [];\n        this.tabIndex = undefined;\n        this.selectedNavIndex = 0;\n        this.cssFile = '';\n        this.hotkeys = {\n            save: 'ctrl+shift+s,command+shift+s'\n        }\n    }\n\n    render() {\n        return html`\n        <iron-ajax id=\"loadContent\"\n                handle-as=\"json\" content-type=\"application/x-www-form-urlencoded\"\n                with-credentials\n                method=\"GET\"></iron-ajax>\n                \n        <iron-ajax id=\"saveOdd\"\n                handle-as=\"json\"\n                with-credentials></iron-ajax>\n\n        <div id=\"layout\">\n            <div id=\"drawer\">\n                    <slot id=\"slot\"></slot>\n                    <h3>\n                        <span>${this.odd}</span>\n\n                        <span class=\"icons\">\n                            <pb-edit-xml id=\"editSource\"><paper-icon-button icon=\"code\" title=\"${translate('odd.editor.odd-source')}\"></paper-icon-button></pb-edit-xml>\n                            <paper-icon-button @click=\"${this._reload}\" icon=\"refresh\" title=\"${translate('odd.editor.reload')}\"></paper-icon-button>\n                            <paper-icon-button @click=\"${this.save}\" icon=\"save\" title=\"${translate('odd.editor.save')} ${this.display('save')}\" \n                                ?disabled=\"${!this.loggedIn}\"></paper-icon-button>\n                        </span>\n                    </h3>\n                    <div id=\"new-element\" class=\"input-group\">\n                        <paper-input id=\"identNew\" label=\"${translate('odd.editor.add-element')}\" always-float-label=\"always-float-label\">\n                            <paper-icon-button slot=\"suffix\" @click=\"${this.addElementSpec}\" icon=\"add\" tabindex=\"-1\"></paper-icon-button>\n                        </paper-input>\n                    </div>\n\n                    <div id=\"jump-to\">\n                        <paper-autocomplete id=\"jumpTo\" label=\"${translate('odd.editor.jump-to')}\" always-float-label=\"always-float-label\"></paper-autocomplete>\n                    </div>\n                    \n                    <h3>${translate('odd.editor.specs')}</h3>\n            </div>\n            <div id=\"navlist\">\n                ${repeat(this.elementSpecs, (i) => i.ident, (i, index) =>\n            html`\n                    <paper-item id=\"es_${i.ident}\"\n                        index=\"${index}\"\n                        @click=\"${(ev) => this._openElementSpec(ev, index)}\">${i.ident}</paper-item>\n                `)}\n            </div>\n            <section class=\"specs\" id=\"specs\">\n    \n                <paper-card class=\"metadata\">\n                    <pb-collapse id=\"meta\">\n                        <h4 slot=\"collapse-trigger\" class=\"panel-title\">\n                            ${this._computedTitle()}\n                        </h4>\n                        <div slot=\"collapse-content\">\n                            <paper-input id=\"title\" name=\"title\" value=\"${this.title}\" label=\"${translate('odd.editor.title')}\"\n                                         placeholder=\"[${translate('odd.editor.title-placeholder')}]\"\n                                         @change=\"${this._inputTitle}\"></paper-input>\n                            <paper-input id=\"titleShort\" name=\"short-title\" .value=\"${this.titleShort}\" label=\"${translate('odd.editor.title-short')}\"\n                                         placeholder=\"[${translate('odd.editor.title-short-placeholder')}]\"\n                                         @change=\"${(e) => this.titleShort = e.composedPath()[0].value}\"></paper-input>\n                            <paper-input id=\"description\" name=\"description\" .value=\"${ifDefined(this.description)}\" label=\"${translate('odd.editor.description-label')}\"\n                                      placeholder=\"[${translate('odd.editor.description-placeholder')}]\"\n                                      @change=\"${(e) => this.description = e.composedPath()[0].value}\"></paper-input>\n                            <paper-input id=\"source\" name=\"source\" ?value=\"${this.source}\" label=\"${translate('odd.editor.source-label')}\"\n                                         placeholder=\"[${translate('odd.editor.source-placeholder')}]\"\n                                         @change=\"${(e) => this.source = e.composedPath()[0].value}\"></paper-input>\n                            <paper-checkbox id=\"useNamespace\" @change=\"${this.setUseNamespace}\">${translate('odd.editor.use-namespace')}</paper-checkbox>\n                            <paper-input id=\"namespace\" name=\"namespace\" value=\"${this.namespace}\" label=\"Namespace\" ?disabled=\"${!this.useNamespace}\"\n                                         placeholder=\"[${translate('odd.editor.namespace-placeholder')}]\"\n                                         @change=\"${(e) => this.namespace = e.composedPath()[0].value}\"></paper-input>\n                            <div class=\"extCssEdit\">\n                                <paper-input name=\"cssFile\" value=\"${this.cssFile}\" label=\"External CSS File\"\n                                    placeholder=\"[External CSS file with additional class definitions]\"\n                                    @change=\"${this._cssFileChanged}\"></paper-input>\n                                <pb-edit-xml id=\"editCSS\"><paper-icon-button icon=\"create\" title=\"${translate('odd.editor.css-source')}\"></paper-icon-button></pb-edit-xml>\n                            </div>\n                        </div>\n                    </pb-collapse>\n                </paper-card>\n    \n                <!-- todo: import elementspec to make it function  -->\n    \n                <div class=\"editingView\">\n                    <vaadin-tabs id=\"tabs\" selected=\"${this.tabIndex}\">\n                        ${repeat(this.tabs, (i) => i.id, (i, index) =>\n                html`\n                            <vaadin-tab name=\"${i}\" @click=\"${(e) => this._selectTab(e, i)}\"><span style=\"padding-right:20px;\">${i}</span><paper-icon-button icon=\"close\" @click=\"${(ev) => this._closeTabHandler(ev, index)}\"></paper-icon-button></vaadin-tab>\n                        `)}                    \n                    </vaadin-tabs>\n                                       \n                    <div id=\"currentElement\"></div>\n                </div>\n            </section>\n            \n        </div>\n\n\n        <pb-message id=\"dialog\" hidden></pb-message>\n        <pb-message id=\"errorMsg\"></pb-message>\n        `;\n    }\n\n    firstUpdated(changedProperties) {\n        this.shadowRoot.getElementById('useNamespace').checked = this.useNamespace;\n\n        // console.log('firstUpdated ', changedProperties);\n        // console.log('firstUpdated endpoint', this.getEndpoint());\n        // console.log('firstUpdated rootpath', this.rootPath);\n        this.jumpCtrl = this.shadowRoot.getElementById('jumpTo');\n        this.jumpCtrl.addEventListener('autocomplete-selected', this.jumpTo.bind(this));\n\n        const oddSelector = this.querySelector('odd-selector');\n\n        if (this.odd && oddSelector) {\n            oddSelector.selected = this.odd;\n\n            oddSelector.addEventListener('odd-selected', e => {\n                if (confirm('Any unsaved changes will be lost. Continue?')) {\n                    this.odd = e.detail.odd;\n                    window.history.pushState({}, \"\", '?odd=' + this.odd)\n                }\n                oddSelector.selected = this.odd;\n            })\n        }\n\n        this.addEventListener('current-changed', this._changeSelection);\n        this.addEventListener('odd-copy', e => this._copy(e));\n        this.addEventListener('odd-paste', e => this._paste(e));\n        this.addEventListener('element-spec-removed', this.removeElementSpec.bind(this));\n\n        window.addEventListener('beforeunload', () => 'Any unsaved changes will be lost. Continue?');\n\n        this.subscribeTo('pb-login', (ev) => {\n            this.loggedIn = ev.detail.user != null;\n        });\n\n        this.focus();\n\n        this.loadContent = this.shadowRoot.getElementById('loadContent');\n\n        // it is unclear to me why root-path is not read from attribute without this explicit call\n        this.rootPath = this.getAttribute('root-path');\n\n        PbOddEditor.waitOnce('pb-page-ready', () => {\n            this.load();\n            this.inited = true;\n        });\n\n        this.registerHotkey('save', this.save.bind(this));\n    }\n\n    setUseNamespace() {\n        this.useNamespace = this.shadowRoot.getElementById('useNamespace').checked;\n    }\n\n    async load() {\n        if (this.loading) {\n            return;\n        }\n        this.loading = true;\n\n        if (this.rootPath === '' || this.odd === '') {\n            return;\n        }\n\n        // reset\n        this.elementSpecs = [];\n\n        document.dispatchEvent(new CustomEvent('pb-start-update'));\n\n\n        // this.$.editSource.setPath(this.rootPath + '/' + this.odd);\n        const editSrc = this.shadowRoot.getElementById('editSource');\n        editSrc.setPath(this.rootPath + '/' + this.odd);\n        // this.shadowRoot.getElementById('editSource').setPath(this.rootPath + '/' + this.odd)\n\n        const params = { odd: this.odd, root: this.rootPath };\n\n        // this.$.loadContent.params = params;\n        this.loadContent.params = params;\n        this.loadContent.url = `${this.getEndpoint()}/${this.lessThanApiVersion('1.0.0') ? 'modules/editor.xql' : 'api/odd/' + this.odd}`;\n        const request = this.loadContent.generateRequest();\n\n        request.completes.then(r => this.handleOdd(r));\n    }\n\n    handleOdd(req) {\n        const data = req.response;\n        this.loggedIn = data.canWrite;\n        this.source = data.source;\n        this.title = data.title;\n        this.titleShort = data.titleShort;\n        this.description = data.description;\n        this.cssFile = data.cssFile == null ? '' : data.cssFile;\n        this.namespace = data.namespace != null ? data.namespace : '';\n        this.useNamespace = data.namespace != null;\n\n        if (this.cssFile) {\n            const editCss = this.shadowRoot.getElementById('editCSS');\n            editCss.setPath(this.rootPath + '/' + this.cssFile);\n        }\n\n        // update elementSpecs\n        this.elementSpecs = data.elementSpecs.map(es => this.mapElementSpec(es));\n\n        // init auto-complete list\n        // const jumpTo = this.shadowRoot.getElementById('jumpTo');\n        // jumpTo.source = this.elementSpecs.map(this._specMapper);\n        this._updateAutoComplete();\n\n        this.requestUpdate();\n\n        this.loading = false;\n        document.dispatchEvent(new CustomEvent('pb-end-update'));\n\n        document.title = this.titleShort || this.title;\n    }\n\n    _updateAutoComplete() {\n        const jumpTo = this.shadowRoot.getElementById('jumpTo');\n        jumpTo.source = this.elementSpecs.map(this._specMapper);\n    }\n\n    _cssFileChanged(e) {\n        this.cssFile = e.composedPath()[0].value;\n        if (this.cssFile) {\n            const editCss = this.shadowRoot.getElementById('editCSS');\n            editCss.setPath(this.rootPath + '/' + this.cssFile);\n        }\n    }\n\n    /**\n     * handler for paper-item in navigation list in the drawer\n     *\n     * @param e\n     * @param index\n     * @private\n     */\n    _navlistActiveChanged(e, index) {\n        // set the paper-item active that got the click\n        this.selectedNavIndex = index;\n        this.requestUpdate();\n    }\n\n    _returnTabs() {\n        return this.tabs;\n    }\n\n    _selectTab(e, item) {\n        const spec = this.elementSpecs.find(theSpec => theSpec.ident === item);\n        this._updateElementspec(spec);\n    }\n\n    _openElementSpec(ev, index) {\n        console.log('_openElementSpec ', ev, index);\n\n        const spec = this.elementSpecs[index]; //get target elementspec\n        this._updateElementspec(spec);\n\n        const ident = spec.ident;\n\n        // do not re-open existing tab, but select it\n        if (this.tabs.indexOf(ident) >= 0) {\n            this.tabIndex = this.tabs.indexOf(ident);\n            this.requestUpdate();\n            return;\n        }\n\n        this.tabs.push(ident);\n        this.tabIndex = this.tabs.length - 1;\n        this.requestUpdate();\n    }\n\n    _updateElementspec(elementSpec) {\n        // const spec = this.elementSpecs.find(theSpec => theSpec.ident === specIdent);\n\n        // reset - delete current element if there's one\n        const currentElement = this.shadowRoot.getElementById('currentElement');\n        currentElement.innerHTML = \"\";\n\n        // create new elementspec\n        const newElementSpec = new PbOddElementspecEditor();\n        newElementSpec.addEventListener('element-spec-changed', this.handleElementSpecChanged.bind(this));\n        newElementSpec.ident = elementSpec.ident;\n        newElementSpec.models = elementSpec.models;\n        newElementSpec.mode = elementSpec.mode;\n        newElementSpec.endpoint = this._endpoint;\n        newElementSpec.apiVersion = this._apiVersion;\n\n        newElementSpec.hotkeys = this.hotkeys;\n        currentElement.appendChild(newElementSpec);\n    }\n\n    _closeTabHandler(ev, index) {\n        console.log('_closeTabHandler ', index);\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        this._closeTab(index);\n        return false;\n    }\n\n    _closeTab(index) {\n        this.tabs.splice(index, 1);\n        // last tab closed\n        if (this.tabs.length === 0) {\n            this.shadowRoot.getElementById('currentElement').innerHTML = '';\n            this.tabIndex = 0;\n            this.tabs = [];\n        }\n        // a tab left of selected tab or current tab closed\n        else if (this.tabIndex > 0 && this.tabIndex >= index) {\n            // decrease tabIndex by one\n            this.tabIndex -= 1;\n\n            const currentTab = this.tabs[this.tabIndex];\n            this._selectTab(null, currentTab);\n        }\n    }\n\n    attributeChangedCallback(name, oldVal, newVal) {\n        // console.log('attributeChangedCallback', name, oldVal, newVal);\n\n        super.attributeChangedCallback(name, oldVal, newVal);\n        if (name == 'odd' && oldVal !== newVal) {\n            // console.log('<pb-document> Emit update event');\n            // this.emitTo('pb-odd-editor', this);\n            if (this.inited) {\n                this.load();\n            }\n        }\n    }\n\n    static get replaceCharMap() {\n        return {\n            '\"': '&quot;',\n            '&': '&amp;',\n            '<': '&lt;',\n            '>': '&gt;'\n        }\n    };\n\n    static get replaceCharRegexp() {\n        return /\"|&|<|>/g\n    }\n\n    static replaceChars(match) {\n        return PbOddEditor.replaceCharMap[match];\n    }\n\n    jumpTo(e) {\n        const jumpCtrl = this.shadowRoot.getElementById('jumpTo');\n        const id = '#es_' + jumpCtrl.text;\n        const target = this.shadowRoot.querySelector(id);\n        if (!target) {\n            return\n        }\n\n        this.jumpCtrl.clear();\n        target.click();\n    }\n\n    _computedTitle() {\n        if (!this.odd) {\n            return ''\n        }\n        return this.title || this.titleShort || this.odd || 'Loading ...'\n    }\n\n    _copy(e) {\n        // console.log('odd-editor._copy ', e);\n        this.clipboard = e.detail.model;\n        const clone = JSON.parse(JSON.stringify(e.detail.model));\n        this.clipboard = clone;\n    }\n\n    _paste(e) {\n        console.log('_paste ', e);\n        console.log('_paste clipboard', this.clipboard);\n\n        if (this.clipboard == {} || this.clipboard == undefined) {\n            return;\n        }\n        const targetElement = e.detail.target;\n        targetElement.addModel(this.clipboard);\n        targetElement.render();\n    }\n\n    _specMapper(spec) {\n        return {\n            text: spec.ident,\n            value: spec.ident\n        };\n    }\n\n    _specObserver(changeRecord) {\n        const source = this.elementSpecs.map(this._specMapper);\n        this.jumpCtrl.source = source;\n    }\n\n    mapElementSpec(elementSpec) {\n        return Object.assign(\n            {},\n            elementSpec,\n            { models: elementSpec.models.map(m => this.addShowToModel(m)) }\n        );\n    }\n\n    addShowToModel(model) {\n        if (model.models) {\n            const extendedModels = model.models.map(m => this.addShowToModel(m));\n            return Object.assign({}, model, { models: extendedModels, show: false });\n        }\n        return Object.assign({}, model, { show: false });\n    }\n\n    addElementSpec(ev) {\n        // const ident = this.$.identNew.value;\n        const identNew = this.shadowRoot.getElementById('identNew');\n\n        const ident = identNew.value;\n        if (!ident || ident.length === 0) {\n            return;\n        }\n        const existingSpec = this.elementSpecs.find((spec) => spec.ident === ident);\n        if (existingSpec) {\n            console.log('<pb-odd-editor> element spec to be added already exists: %s', ident);\n            const id = `#es_${ident}`;\n            const target = this.shadowRoot.querySelector(id);\n            if (!target) {\n                return\n            }\n            target.click();\n            return;\n        }\n\n        const oldApiParams = {\n            action: \"find\",\n            odd: this.odd,\n            root: this.rootPath,\n            ident\n        };\n        const newApiParams = {\n            root: this.rootPath,\n            ident\n        };\n\n        const params = this.lessThanApiVersion('1.0.0') ? oldApiParams : newApiParams;\n\n        this.loadContent.params = params;\n        this.loadContent.url = `${this.getEndpoint()}/${this.lessThanApiVersion('1.0.0') ? 'modules/editor.xql' : 'api/odd/' + this.odd}`;\n        let request = this.loadContent.generateRequest();\n        request.completes.then(this._handleElementSpecResponse.bind(this));\n    }\n\n\n    _handleElementSpecResponse(req) {\n        const identNew = this.shadowRoot.getElementById('identNew');\n\n        const data = req.response;\n        const ident = identNew.value\n        const mode = (data.status === 'not-found' ? 'add' : 'change');\n        const models = data.models || [];\n        const newSpec = {\n            ident,\n            mode,\n            models\n        };\n\n        this.elementSpecs.unshift(newSpec);\n        // trigger update of autocomplete list in jumpTo\n        identNew.value = '';\n\n        //open new tab with newly created element\n        this.tabs.push(ident);\n        this.tabIndex = this.tabs.length - 1;\n\n        this.elementSpecs.sort((a, b) => a.ident.localeCompare(b.ident));\n\n        this.requestUpdate().then(() => {\n            const elem = this.shadowRoot.querySelectorAll('paper-item');\n            const idx = this.elementSpecs.indexOf(newSpec);\n\n            this._updateAutoComplete();\n\n            elem[idx].click();\n            elem[idx].focus();\n        });\n    }\n\n    removeElementSpec(ev) {\n        const ident = ev.detail.target.ident;\n        this.shadowRoot.getElementById('dialog')\n            .confirm(i18n('browse.delete'), i18n('odd.editor.delete-spec', { ident }))\n            .then(() => {\n                const targetIndex = this.elementSpecs.findIndex(theSpec => theSpec.ident === ident);\n                this.elementSpecs.splice(targetIndex, 1);\n                this.requestUpdate();\n\n\n                const selectedTab = this.shadowRoot.querySelector('vaadin-tab[selected]');\n                const tabName = selectedTab.getAttribute('name');\n                const idx = this.tabs.indexOf(tabName);\n                this._closeTab(idx);\n            }, () => null);\n    }\n\n    serializeOdd() {\n        const ns = this.useNamespace ? ` ns=\"${this.namespace}\"` : '';\n        const source = this.source ? ` source=\"${this.source}\"` : '';\n        const description = this.description ? ` <desc>${this.description}</desc>` : '';\n        const title = `${this.indentString}<title>${this.title}${description}</title>\\n`;\n        const titleShort = this.titleShort ? `${this.indentString}<title type=\"short\">${this.titleShort}</title>\\n` : '';\n        const cssFile = this.cssFile ? `${this.indentString}<rendition source=\"${this.cssFile}\"/>\\n` : '';\n        const elementSpecs = this.elementSpecs\n            .map(e => this.serializeElementSpec(this.indentString, e)).join('');\n\n        return `<schemaSpec xmlns=\"http://www.tei-c.org/ns/1.0\" xmlns:pb=\"http://teipublisher.com/1.0\"${ns}${source}>\\n${title}${titleShort}${cssFile}\\n${elementSpecs}</schemaSpec>\\n`\n    }\n\n    serializeElementSpec(indent, elementSpec) {\n        const mode = elementSpec.mode ? ` mode=\"${elementSpec.mode}\"` : '';\n        const indent2 = indent + this.indentString\n        const models = elementSpec.models\n            .map(m => this.serializeModel(indent2, m))\n            .join('')\n\n        return `${indent}<elementSpec ident=\"${elementSpec.ident}\"${mode}>\\n${models}${indent}</elementSpec>\\n`;\n    }\n\n    serializeModel(indent, model) {\n        if (model.type === 'model' && !model.behaviour) {\n            return '';\n        }\n\n        const nestedIndent = indent + this.indentString;\n\n        const attributes = [\n            this.serializeAttribute('output', model.output),\n            this.serializeAttribute('predicate', model.predicate),\n            model.type === 'model' ? this.serializeAttribute('behaviour', model.behaviour) : '',\n            this.serializeAttribute('cssClass', model.css),\n            this.serializeAttribute('useSourceRendition', model.sourcerend),\n            this.serializeAttribute('pb:mode', model.mode)\n        ].join('');\n\n        const desc = model.desc ? nestedIndent + '<desc>' + model.desc + '</desc>\\n' : '';\n\n        // innerXML += this.serializeTag('model', nestedIndent);\n        const models = model.models.map(m => this.serializeModel(nestedIndent, m)).join('');\n        const parameters = model.parameters.map(p => this.serializeParameter(nestedIndent, p)).join('');\n        const renditions = model.renditions.map(r => this.serializeRendition(nestedIndent, r)).join('');\n        const template = PbOddEditor.serializeTemplate(nestedIndent, model.template);\n        const innerXML = `${desc}${models}${parameters}${template}${renditions}`;\n        const end = (innerXML.length > 0) ? `>\\n${innerXML}${indent}</${model.type}` : '/';\n\n        return `${indent}<${model.type}${attributes}${end}>\\n`\n    }\n\n    serializeParameter(indent, parameter) {\n        if (!parameter.name) {\n            return '';\n        }\n        const name = this.serializeAttribute('name', parameter.name);\n        const value = this.serializeAttribute('value', parameter.value);\n        if (parameter.set) {\n            return `${indent}<pb:set-param xmlns=\"\"${name}${value}/>\\n`\n        }\n        return `${indent}<param${name}${value}/>\\n`\n    }\n\n    serializeRendition(indent, rendition) {\n        const scope = rendition.scope && rendition.scope !== 'null' ? this.serializeAttribute('scope', rendition.scope) : '';\n        const css = PbOddEditor.escape(rendition.css);\n        return `${indent}<outputRendition xml:space=\"preserve\" ${scope}>\\n${indent}${css}\\n${indent}</outputRendition>\\n`;\n    }\n\n    static serializeTemplate(indent, template) {\n        if (!template) {\n            return '';\n        }\n        return `${indent}<pb:template xml:space=\"preserve\" xmlns=\"\">${template}</pb:template>\\n`;\n    }\n\n    serializeAttribute(name, value) {\n        return value ? ` ${name}=\"${PbOddEditor.escape(value)}\"` : ''\n    }\n\n    static escape(code) {\n        if (!code) {\n            return '';\n        }\n        if (typeof code === 'string') {\n            return code.replace(PbOddEditor.replaceCharRegexp, PbOddEditor.replaceChars);\n        }\n        return code;\n    }\n\n    save(e) {\n        document.dispatchEvent(new CustomEvent('pb-start-update'));\n        const data = this.serializeOdd()\n        console.log('serialised ODD:', data)\n\n        this.shadowRoot.getElementById('dialog').show(i18n(\"odd.editor.save\"), i18n('odd.editor.saving'));\n\n        const saveOdd = this.shadowRoot.getElementById('saveOdd');\n        saveOdd.url = `${this.getEndpoint()}/${this.lessThanApiVersion('1.0.0') ? 'modules/editor.xql' : 'api/odd/' + this.odd}`;\n        if (this.lessThanApiVersion('1.0.0')) {\n            saveOdd.contentType = 'application/x-www-form-urlencoded';\n            saveOdd.method = \"POST\";\n            saveOdd.params = null;\n            saveOdd.body = {\n                action: \"save\",\n                root: this.rootPath,\n                \"output-prefix\": this.outputPrefix,\n                \"output-root\": this.outputRoot,\n                odd: this.odd,\n                data\n            };\n        } else {\n            saveOdd.contentType = 'application/xml';\n            saveOdd.method = \"PUT\";\n            saveOdd.params = {\n                root: this.rootPath,\n                \"output-prefix\": this.outputPrefix,\n                \"output-root\": this.outputRoot,};\n            saveOdd.body = data;\n        }\n        \n        const request = saveOdd.generateRequest();\n        request.completes\n            .then(this.handleSaveComplete.bind(this))\n            .catch(this.handleSaveError.bind(this));\n    }\n\n    //to be deprecated: only used for old api\n    static _renderReport(report) {\n        if (report.error) {\n            return `\n                        <div class=\"list-group-item-danger\">\n                          <h4 class=\"list-group-item-heading\">${report.file}</h4>\n                          <h5 class=\"list-group-item-heading\">Compilation error on line ${report.line}:</h5>\n                          <pre class=\"list-group-item-text\">${report.error}</pre>\n                          <pre class=\"list-group-item-text\">${report.message}</pre>\n                        </div>\n                    `;\n        }\n        return `\n                    <div class=\"list-group-item-success\">\n                      <p class=\"list-group-item-text\">Generated ${report.file}</p>\n                    </div>\n                `;\n    }\n\n    handleSaveComplete(req) {\n        const data = req.response;\n        if (data.status === 'denied') {\n            this.shadowRoot.getElementById('dialog').set(i18n(\"odd.editor.denied\"), i18n(\"odd.editor.denied-message\", { odd: this.odd }));\n            document.dispatchEvent(new CustomEvent('pb-end-update'));\n            return;\n        }\n\n        let msg;\n\n        if (this.lessThanApiVersion('1.0.0')) {\n            const report = data.report.map(PbOddEditor._renderReport);\n            msg = `<div class=\"list-group\">${report.join('')}</div>`;\n        } else {\n            const report = data.report;\n            msg = `<div class=\"list-group\">${report}</div>`;\n        }\n        \n        this.shadowRoot.getElementById('dialog').set(i18n(\"odd.editor.saved\"), msg);\n\n        document.dispatchEvent(new CustomEvent('pb-end-update'));\n    }\n\n    handleSaveError(rejected) {\n        this.shadowRoot.getElementById('dialog').set(\"Error\", rejected.error);\n        // this.$.dialog.set(\"Error\", rejected.error);\n        document.dispatchEvent(new CustomEvent('pb-end-update'));\n    }\n\n    _reload() {\n        this.shadowRoot.getElementById('dialog')\n            .confirm(i18n('odd.editor.reload'), i18n('odd.editor.reload-confirm'))\n            .then(() => {\n                this.load();\n                this.tabs = [];\n                this.tabIndex = 0;\n                this.shadowRoot.getElementById('currentElement').innerHTML = '';\n            }, () => null);\n    }\n\n    _setCurrentSelection(e) {\n        if (this.currentSelection != undefined) {\n            this.currentSelection.removeAttribute('currentselection');\n        }\n        this.currentSelection = e.target;\n        this.currentSelection.setAttribute('currentselection', 'true');\n    }\n\n\n    _changeSelection(ev) {\n        ev.preventDefault();\n        ev.stopPropagation();\n\n        if (ev.detail.target === this) return;\n\n        if (this.currentSelection &&\n            this.currentSelection.tagName !== undefined) {\n            this.currentSelection.removeAttribute('currentselection');\n        }\n\n        let newSelection;\n        if (ev.detail.target) {\n            newSelection = ev.detail.target;\n        } else {\n            newSelection = ev.target;\n        }\n        newSelection.setAttribute('currentselection', 'true');\n        this.currentSelection = newSelection;\n    }\n\n    _selectElementspec(e) {\n        if (this.currentElementSpec &&\n            this.currentElementSpec.tagName === 'PB-ODD-ELEMENTSPEC-EDITOR') {\n            this.currentElementSpec.removeAttribute('currentselection');\n        }\n        const newSelection = e.target;\n        newSelection.setAttribute('currentselection', 'true');\n        this.currentElementSpec = newSelection;\n    }\n\n    nsDisabled() {\n        return !this.useNamespace;\n    }\n\n    _handleLoadError(e) {\n        console.log('loading error occurred: ', e);\n        const msg = this.shadowRoot.getElementById('errorMsg');\n        msg.style.background = 'red';\n        const url = this.shadowRoot.getElementById('loadContent').url;\n        console.log('url ', url);\n        msg.show('Error: ', 'ODD file could not be loaded from ' + url);\n    }\n\n\n    handleElementSpecChanged(e) {\n        // console.log('handleElementSpecChanged ',e);\n        const elementSpec = this.elementSpecs.find(es => es.ident === e.detail.ident);\n        const index = this.elementSpecs.indexOf(elementSpec);\n        const newSpec = Object.assign({}, elementSpec, { models: e.detail.models });\n        const allSpecs = Array.from(this.elementSpecs);\n        allSpecs.splice(index, 1, newSpec)\n        this.elementSpecs = allSpecs;\n        // console.log('updated elementspecs ', this.elementSpecs);\n\n    }\n\n    _inputTitle(ev) {\n        this.title = ev.composedPath()[0].value;\n    }\n\n}\n\ncustomElements.define('pb-odd-editor', PbOddEditor);\n"],"names":["$_documentContainer","html","document","head","appendChild","content","ItemMixin","superClass","VaadinItemMixin","properties","_hasVaadinItemMixin","value","disabled","type","Boolean","observer","reflectToAttribute","selected","_value","String","undefined","textContent","trim","ready","attrValue","getAttribute","addEventListener","e","_setFocused","_setActive","_mousedown","mouseUpListener","removeEventListener","_onKeydown","_onKeyup","disconnectedCallback","hasAttribute","_selectedChanged","setAttribute","_disabledChanged","blur","removeAttribute","focused","active","event","test","key","defaultPrevented","preventDefault","click","TabElement","ElementMixin","ThemableMixin","PolymerElement","template","is","version","willClick","anchor","querySelector","customElements","define","ListMixin","VaadinListMixin","_hasVaadinListMixin","Number","notify","orientation","items","Array","readOnly","_searchBuf","observers","_onClick","_observer","FlattenedNodesObserver","info","_setItems","_filterItems","from","children","_enhanceItems","forEach","item","updateStyles","_setFocusable","itemToSelect","_scrollToItem","getRootNode","activeElement","array","filter","metaKey","shiftKey","ctrlKey","composedPath","idx","indexOf","_searchKey","currentIdx","_searchReset","Debouncer","debounce","timeOut","after","toLowerCase","increment","condition","_isItemHidden","replace","some","length","_getAvailableIndex","_isRTL","_vertical","_focus","dirIncrement","totalItems","i","getComputedStyle","display","tabIndex","focus","flush","firstItem","_scrollerElement","props","scrollerRect","getBoundingClientRect","nextItemRect","prevItemRect","scrollDistance","_scroll","pixels","scrollType","DirHelper","detectScrollType","scrollLeft","getNormalizedScrollLeft","setNormalizedScrollLeft","safari10","navigator","userAgent","TabsElement","mixinBehaviors","IronResizableBehavior","_updateOverflow","afterNextRender","_scrollForward","__direction","_scrollOffset","_scrollBack","offsetHeight","offsetWidth","$","scroll","scrollPosition","scrollTop","__getNormalizedScrollLeft","scrollSize","scrollHeight","scrollWidth","overflow","matched","_repaintShadowNodesHack","root","WEBKIT_PROPERTY","querySelectorAll","el","style","PbOddRenditionEditor","LitElement","styles","css","render","scope","_listchanged","scopes","map","_handleCodeChange","_remove","reflect","constructor","_initialized","connectedCallback","dispatchEvent","CustomEvent","composed","bubbles","detail","target","firstUpdated","changedProperties","refreshEditor","console","log","editor","shadowRoot","getElementById","refresh","ev","getSource","name","scopelist","PbOddParameterEditor","translate","_currentParameters","endpoint","cmpVersion","apiVersion","setParam","_delete","behaviour","parameters","Object","attribute","currentParameters","alternate","block","body","break","cell","cit","figure","graphic","heading","inline","link","list","listItem","metadata","note","omit","paragraph","row","section","table","text","title","webcomponent","attributeChangedCallback","old","requestUpdate","bind","checked","set","PbOddModelEditor","predicate","converter","output","mode","model","models","renditions","desc","sourcerend","show","outputs","behaviours","icon","open","hasCustomBehaviour","parentModel","toggle","_isGroupOrSequence","_moveDown","_moveUp","_requestRemoval","_copy","_paste","_isModel","_addNested","_selectOutput","_inputMode","_inputDesc","_updatePredicate","_selectBehaviour","_handleCustomBehaviour","_inputCss","_updateTemplate","_addParameter","repeat","parameter","index","_removeParam","_updateParam","_addRendition","rendition","_removeRendition","_updateRendition","_removeModel","_moveModelDown","_moveModelUp","handleModelChanged","setCurrentSelection","updated","_changedProperties","has","refreshEditors","toggleButtonIcon","oldModel","newModel","assign","_templateMode","_changeSelection","stopPropagation","currentSelection","newSelection","newNestedModel","unshift","modelTypeSelector","select","confirm","i18n","then","splice","targetModel","_setCurrentSelection","_fireModelChanged","push","prop","PbOddElementspecEditor","ident","_addModel","addModel","action","PbOddEditor","pbHotkeys","pbMixin","odd","elementSpecs","source","titleShort","description","namespace","rootPath","loading","indentString","outputPrefix","outputRoot","useNamespace","loggedIn","tabs","selectedNavIndex","cssFile","hotkeys","save","_reload","addElementSpec","_openElementSpec","_computedTitle","_inputTitle","ifDefined","setUseNamespace","_cssFileChanged","id","_selectTab","_closeTabHandler","jumpCtrl","jumpTo","oddSelector","window","history","pushState","removeElementSpec","subscribeTo","user","loadContent","waitOnce","load","inited","registerHotkey","editSrc","setPath","params","url","getEndpoint","lessThanApiVersion","request","generateRequest","completes","r","handleOdd","req","data","response","canWrite","editCss","es","mapElementSpec","_updateAutoComplete","_specMapper","_navlistActiveChanged","_returnTabs","spec","find","theSpec","_updateElementspec","elementSpec","currentElement","innerHTML","newElementSpec","handleElementSpecChanged","_endpoint","_apiVersion","_closeTab","currentTab","oldVal","newVal","replaceCharMap","replaceCharRegexp","replaceChars","match","clear","clipboard","clone","JSON","parse","stringify","targetElement","_specObserver","changeRecord","m","addShowToModel","extendedModels","identNew","existingSpec","oldApiParams","newApiParams","_handleElementSpecResponse","status","newSpec","sort","a","b","localeCompare","elem","targetIndex","findIndex","selectedTab","tabName","serializeOdd","ns","serializeElementSpec","join","indent","indent2","serializeModel","nestedIndent","attributes","serializeAttribute","p","serializeParameter","serializeRendition","serializeTemplate","innerXML","end","escape","code","saveOdd","contentType","method","handleSaveComplete","catch","handleSaveError","_renderReport","report","error","file","line","message","msg","rejected","tagName","_selectElementspec","currentElementSpec","nsDisabled","_handleLoadError","background","allSpecs"],"mappings":";;;;AAAA;;;;;;;;;;;;AAYG;AASH;;AACA,MAAM,mBAAmB,GACrB,CAAC,aAAD,EAA0B,UAA1B,KAA6D;AAC3D,QAAM,SAAS,GAAG,aAAa,CAAC,SAAd,CAAwB,UAA1C;AACA,QAAM,UAAU,GAAG,UAAU,KAAK,SAAf,GAA2B,aAAa,CAAC,OAAzC,GAC2B,UAAU,CAAC,SADzD;AAEA,QAAM,SAAS,GAAG,SAAS,CAAC,YAAV,CAAuB,YAAY,EAAnC,EAAuC,UAAvC,CAAlB;AACA,EAAA,SAAS,CAAC,YAAV,CAAuB,YAAY,EAAnC,EAAuC,UAAvC;AACA,QAAM,OAAO,GAAG,IAAI,QAAJ,CAAa,aAAa,CAAC,OAA3B,CAAhB;AACA,EAAA,OAAO,CAAC,eAAR,CAAwB,SAAxB;AACA,SAAO,OAAP;AACD,CAVL;;AAYA,MAAM,UAAU,GAAG,CAAC,IAAD,EAAiB,KAAjB,KAAmC;AACpD,EAAA,IAAI,CAAC,QAAL,CAAc,KAAd;AACA,EAAA,IAAI,CAAC,MAAL;AACA,SAAO,IAAP;AACD,CAJD;;AAMA,MAAM,gBAAgB,GAClB,CAAC,aAAD,EAA0B,IAA1B,EAA0C,GAA1C,KAA4D;AAC1D,QAAM,SAAS,GAAG,aAAa,CAAC,SAAd,CAAwB,UAA1C;AACA,QAAM,UAAU,GAAG,GAAG,GAAG,GAAG,CAAC,SAAP,GAAmB,aAAa,CAAC,OAAvD;AACA,QAAM,OAAO,GAAG,IAAI,CAAC,OAAL,CAAa,WAA7B;;AACA,MAAI,OAAO,KAAK,UAAhB,EAA4B;AAC1B,IAAA,aAAa,CAAC,SAAD,EAAY,IAAI,CAAC,SAAjB,EAA4B,OAA5B,EAAqC,UAArC,CAAb;AACD;AACF,CARL;;AAUA,MAAM,UAAU,GAAI,IAAD,IAAmB;AACpC,EAAA,WAAW,CACP,IAAI,CAAC,SAAL,CAAe,UADR,EACqB,IAAI,CAAC,SAD1B,EACqC,IAAI,CAAC,OAAL,CAAa,WADlD,CAAX;AAED,CAHD;AAMA;AACA;;;AACA,MAAM,WAAW,GAAG,CAAC,IAAD,EAAkB,KAAlB,EAAiC,GAAjC,KAAgD;AAClE,QAAM,GAAG,GAAG,IAAI,GAAJ,EAAZ;;AACA,OAAK,IAAI,CAAC,GAAG,KAAb,EAAoB,CAAC,IAAI,GAAzB,EAA8B,CAAC,EAA/B,EAAmC;AACjC,IAAA,GAAG,CAAC,GAAJ,CAAQ,IAAI,CAAC,CAAD,CAAZ,EAAiB,CAAjB;AACD;;AACD,SAAO,GAAP;AACD,CAND;;;AASA,MAAM,aAAa,GAAG,IAAI,OAAJ,EAAtB;AACA,MAAM,YAAY,GAAG,IAAI,OAAJ,EAArB;AAEA;;;;;;;;;;;;;;;;;;AAkBG;;AACI,MAAM,MAAM,GACf,SAAS,CACL,CAAI,KAAJ,EACI,eADJ,EAEI,QAFJ,KAGkB;AACZ,MAAI,KAAJ;;AACA,MAAI,QAAQ,KAAK,SAAjB,EAA4B;AAC1B,IAAA,QAAQ,GAAG,eAAX;AACD,GAFD,MAEO,IAAI,eAAe,KAAK,SAAxB,EAAmC;AACxC,IAAA,KAAK,GAAG,eAAR;AACD;;AAED,SAAQ,aAAD,IAA8B;AACnC,QAAI,EAAE,aAAa,YAAY,QAA3B,CAAJ,EAA0C;AACxC,YAAM,IAAI,KAAJ,CAAU,0CAAV,CAAN;AACD,KAHkC;AAKnC;;;AACA,UAAM,QAAQ,GAAG,aAAa,CAAC,GAAd,CAAkB,aAAlB,KAAoC,EAArD;AACA,UAAM,OAAO,GAAG,YAAY,CAAC,GAAb,CAAiB,aAAjB,KAAmC,EAAnD,CAPmC;AAUnC;AACA;;AACA,UAAM,QAAQ,GAAe,EAA7B,CAZmC;AAenC;;AACA,UAAM,SAAS,GAAc,EAA7B;AACA,UAAM,OAAO,GAAc,EAA3B;AACA,QAAI,KAAK,GAAG,CAAZ;;AACA,SAAK,MAAM,IAAX,IAAmB,KAAnB,EAA0B;AACxB,MAAA,OAAO,CAAC,KAAD,CAAP,GAAiB,KAAK,GAAG,KAAK,CAAC,IAAD,EAAO,KAAP,CAAR,GAAwB,KAA9C;AACA,MAAA,SAAS,CAAC,KAAD,CAAT,GAAmB,QAAU,CAAC,IAAD,EAAO,KAAP,CAA7B;AACA,MAAA,KAAK;AACN,KAvBkC;AA0BnC;AACA;AACA;;;AACA,QAAI,gBAAJ;AACA,QAAI,gBAAJ,CA9BmC;;AAiCnC,QAAI,OAAO,GAAG,CAAd;AACA,QAAI,OAAO,GAAG,QAAQ,CAAC,MAAT,GAAkB,CAAhC;AACA,QAAI,OAAO,GAAG,CAAd;AACA,QAAI,OAAO,GAAG,SAAS,CAAC,MAAV,GAAmB,CAAjC,CApCmC;AAuCnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAO,OAAO,IAAI,OAAX,IAAsB,OAAO,IAAI,OAAxC,EAAiD;AAC/C,UAAI,QAAQ,CAAC,OAAD,CAAR,KAAsB,IAA1B,EAAgC;AAC9B;AACA;AACA,QAAA,OAAO;AACR,OAJD,MAIO,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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cA9NA;AAgOAC,QAAQ,CAACC,IAAT,CAAcC,WAAd,CAA0BJ,mBAAmB,CAACK,OAA9C;;ACtOA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AAAO,MAAMC,SAAS,GAAGC,UAAU,IAAI,MAAMC,eAAN,SAA8BD,UAA9B,CAAyC;AACzD,aAAVE,UAAU,GAAG;AACtB,WAAO;AAEL;AACN;AACA;AACA;AACA;AACA;AACMC,MAAAA,mBAAmB,EAAE;AACnBC,QAAAA,KAAK,EAAE;AADY,OARhB;;AAYL;AACN;A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ACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAtOA;AAwOAC,QAAQ,CAACC,IAAT,CAAcC,WAAd,CAA0BJ,qBAAmB,CAACK,OAA9C;;AChPA;AACA;AACA;AACA;AACA;AACA,AAMA;AACA;AACA;AACA;AACA;;AACA,AA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C4DY,UAD5D;AAED;AACF;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AAvVgF,CAAzE;;AChBP;AACA;AACA;AACA;AACA;AACA,AAUA,MAAMG,QAAQ,GAAG,0BAA0B/F,IAA1B,CAA+BgG,SAAS,CAACC,SAAzC,CAAjB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAMC,WAAN,SACE5F,YAAY,CACVW,SAAS,CACPV,aAAa,CACX4F,cAAc,CAAC,CAACC,qBAAD,CAAD,EAA0B5F,cAA1B,CADH,CADN,CADC,CADd,CAImE;AAC9C,aAARC,QAAQ,GAAG;AACpB,WAAOrD,IAAK;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAtFI;AAuFD;;AAEY,aAAFsD,EAAE,GAAG;AACd,WAAO,aAAP;AACD;;AAEiB,aAAPC,OAAO,GAAG;AACnB,WAAO,OAAP;AACD;;AAEoB,aAAV/C,UAAU,GAAG;AACtB,WAAO;AACL;AACN;AACA;AACA;AACM0D,MAAAA,WAAW,EAAE;AACXxD,QAAAA,KAAK,EAAE,YADI;AAEXE,QAAAA,IAAI,EAAEM;AAFK,OALR;;AAUL;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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SA9LQ;AA+LH;;AAEoB,aAAVpK,UAAU,GAAG;AACpB,WAAO;AACH;AACZ;AACA;AACY2M,MAAAA,SAAS,EAAE;AACPvM,QAAAA,IAAI,EAAEM;AADC,OAJR;;AAOH;AACZ;AACA;AACYoO,MAAAA,SAAS,EAAE;AACP1O,QAAAA,IAAI,EAAEM,MADC;AAEPkK,QAAAA,OAAO,EAAE,IAFF;AAGPmE,QAAAA,SAAS,EAAE,CAAC7O,KAAD,EAAQE,IAAR,KAAiB;AACxB,cAAIF,KAAK,CAAC8F,WAAN,OAAwB,MAA5B,EAAoC;AAChC,mBAAO,EAAP;AACH;;AACD,iBAAO9F,KAAP;AACH;AARM,OAVR;AAoBHE,MAAAA,IAAI,EAAE;AACFA,QAAAA,IAAI,EAAEM,MADJ;AAEFkK,QAAAA,OAAO,EAAE;AAFP,OApBH;AAwBH/H,MAAAA,QAAQ,EAAE;AACNzC,QAAAA,IAAI,EAAEM,MADA;AAENkK,QAAAA,OAAO,EAAE,IAFH;AAGNmE,QAAAA,SAAS,EAAE,CAAC7O,KAAD,EAAQE,IAAR,KAAiB;AACxB,cAAIF,KAAK,CAAC8F,WAAN,OAAwB,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KA;AAApD;AAAzC,KAAxC,CAAnB;AACA,SAAKV,aAAL;AACH;;AA3SkD;AA8SvDtL,cAAc,CAACC,MAAf,CAAsB,2BAAtB,EAAmDoQ,sBAAnD;;ACzUA;AACA,AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,AAAO,MAAMK,WAAN,SAA0BC,SAAS,CAACC,OAAO,CAAC7J,UAAD,CAAR,CAAnC,CAAyD;AAE3C,aAANC,MAAM,GAAG;AAChB,WAAOC,GAAI;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SA3IQ;AA4IH;;AAEoB,aAAVpK,UAAU,GAAG;AACpB,2CACO,MAAMA,UADb;AAEIyT,MAAAA,KAAK,EAAE;AACHrT,QAAAA,IAAI,EAAEM;AADH,OAFX;;AAKI;AACZ;AACA;AACYuO,MAAAA,IAAI,EAAE;AACF7O,QAAAA,IAAI,EAAEM;AADJ,OARV;;AAWI;AACZ;AACA;AACYyO,MAAAA,MAAM,E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"}